
<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>CSAPP：bomb lab | 超级码里奥</title>
    
    <link rel="icon" href="https://o-a-p.github.io/img/author/RoundCornerHead.png" />
    <meta name="description"
        content="开始你的炸弹秀"> 

    <link rel="canonical" href="https://o-a-p.github.io/post/csapp/bomb/" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.4/css/bulma.min.css">
    
    <link rel="stylesheet" href="https://o-a-p.github.io/scss/style.min.615fc25b4089d39f5daa81b0f85c58b457be1ebea119d3df72100d4d0bacc412.css">

    
    <meta property="og:title" content="CSAPP：bomb lab" />
<meta property="og:description" content="开始你的炸弹秀" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://o-a-p.github.io/post/csapp/bomb/" /><meta property="og:image" content="https://o-a-p.github.io/img/CSAPP/bomb.png" /><meta property="og:image" content="https://o-a-p.github.io/img/CSAPP/lbw.jpg" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2024-02-20T20:48:54+08:00" />
<meta property="article:modified_time" content="2024-02-20T20:48:54+08:00" /><meta property="og:site_name" content="超级码里奥" />


    <meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://o-a-p.github.io/img/CSAPP/bomb.png" /><meta name="twitter:title" content="CSAPP：bomb lab"/>
<meta name="twitter:description" content="开始你的炸弹秀"/>

    
    
    

</head>

<script> 
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://cdnjs.loli.net/css2?family=Noto+Serif+SC:wght@400;500;700&display=swap";
        customFont.type = "text/css";
        customFont.rel = "stylesheet";
        document.head.appendChild(customFont);
    }());
</script>
<body><nav class="navbar is-light" role="navigation">
    <div class="container">
        <div class="navbar-brand">
            <a href="/" title="home" class="navbar-item">
                <span class="logo">
                    <h1>超级码里奥</h1>
                </span>
            </a>

            
            <a id="theme-toggle" class="theme-toggle" href="#">
                <img src="https://o-a-p.github.io/svg/sun.svg" alt="sun icon" class="theme-icon" />
            </a>

            <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>

        <div class="navbar-menu">
            <div class="navbar-start">
                
                <a href="/about" class="navbar-item">About</a>
                
                <a href="/post" class="navbar-item">Blog</a>
                
                <a href="/categories" class="navbar-item">Categories</a>
                
                <a href="/photo" class="navbar-item">Photo</a>
                
            </div>

        </div>
        <div class="search">
            <div id="fastSearch">
                <input id="searchInput" tabindex="0" placeholder="Search..">
                <ul id="searchResults">

                </ul>
            </div>
            <a id="search-btn" style="display: inline-block;" href="# ">
                <div class="icon-search"><svg class="search-svg" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg></div>
            </a>
        </div>

        <script src="/js/fuse.min.js"></script> 
        <script src="/js/fastsearch.js"></script>

    </div>
</nav>

<script>
    
    document.addEventListener('DOMContentLoaded', function() {
        var burger = document.querySelector('.navbar-burger');
        burger.addEventListener('click', function() {
            burger.classList.toggle('is-active');
            document.querySelector('.navbar-menu').classList.toggle('is-active');
        });
    });

    
    function setTheme(theme) {
        let body = document.body;
        let themeIcon = document.querySelector(".theme-icon");
        if (theme === "dark") {
            body.classList.add("dark-mode");
            themeIcon.src = "https:\/\/o-a-p.github.io\/svg/moon.svg";
            themeIcon.alt = "moon icon";
        } else {
            body.classList.remove("dark-mode");
            themeIcon.src = "https:\/\/o-a-p.github.io\/svg/sun.svg";
            themeIcon.alt = "sun icon";
        }
        
        localStorage.setItem("theme", theme);
    }

    
    let theme = localStorage.getItem("theme") || "light";
    const isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    if (isDarkMode) {
        
        setTheme('dark');

    } else {
        
        setTheme('light');
    }
    
    setTheme('dark');

    
    document.getElementById("theme-toggle").addEventListener("click", function() {
        if (theme === "light") {
            theme = "dark";
        } else {
            theme = "light";
        }
        setTheme(theme);
    });



</script>

</header><main>
<div class="single-container">
    <div class="archive">
        
        <img src="/img/CSAPP/bomb.png" class="myBigPicture" alt="headPic">
        <h1 class="title is-1">CSAPP：bomb lab</h1>
        <div class="title subtitle heading is-6">
            <div class="author-info columns is-vcentered">
                <div class="column">
                    <div class="columns is-vcentered is-mobile">
                        
                        <div class="column is-narrow">
                            <img src="/img/author/head.jpg" class="author-image">
                        </div>
                        
                        <div class="column">
                            <p>OAP</p>
                            <p><time>February 20, 2024</time>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="small-categories-container">
                    <a class="hover-underline-animation" href="/categories/x86-asm">x86-asm</a>, <a class="hover-underline-animation" href="/categories/csapp">CSAPP</a>
                </div>
            </div>
        </div>
        <div class="content article-content">
            <div class="toc-container">
                
    <div class="post-toc">
        
            <aside>
                <button id="tocButton" ><h4 id="contents" style="margin-left: 1vw;color:rgb(96, 134, 180);margin-bottom: 0;">CONTENTS</h4></button>
                <div id="hide"><nav id="TableOfContents">
  <ul>
    <li><a href="#1-phase_1">1. phase_1</a></li>
    <li><a href="#2-phase_2">2. phase_2</a></li>
    <li><a href="#3-phase_3">3. phase_3</a></li>
    <li><a href="#4-phase_4">4. phase_4</a></li>
    <li><a href="#5-phase_5">5. phase_5</a></li>
    <li><a href="#6-phase_6">6. phase_6</a></li>
    <li><a href="#小结">小结</a></li>
    <li><a href="#参考">参考</a></li>
  </ul>
</nav></div>
            </aside>
        
    </div><script>
    
        let button = document.getElementById('tocButton');
        let hide = document.getElementById("hide");
        let contents=document.getElementById("contents");
        if (button !== null) {
            button.addEventListener("click", function() {
                if (hide.style.display!='block') {
                    hide.style.display='block'
                } else {
                    hide.style.display='none'
                    contents.style.color='rgb(96, 134, 180)'
                }
            });
        }

        
        let _headings = 0;
        if (hide !== null) {
            _headings = hide.getElementsByTagName('a');
        }
        for (let i = 0; i < _headings.length; i++) {
            if (_headings[i].nextElementSibling === null) {
                continue;
            }
            if (_headings[i] == this) {
                continue;
            }
            _headings[i].nextElementSibling.style.display = 'none'
        }
        window.addEventListener('scroll', function() {
            if (hide === null) {
                return;
            }
            let headings = hide.getElementsByTagName('a')
            for (let i = 0; i < headings.length; i++) {
                let id = headings[i].innerText.replace(/\./g, "").toLowerCase().replace(/\//g, "").replace(/\s/g, "-").replace(/[()]/g, '');
                
                let head = document.getElementById(id);
                if (!head) {
                    break
                }
                let rect = head.getBoundingClientRect();
                
                
                let viewportHeight = window.innerHeight || document.documentElement.clientHeight;

                
                
                let centerY = viewportHeight / 2;

                
                let isCenter = rect.top < centerY && rect.bottom > centerY;
                if (isCenter) {
                    
                    let _headings = hide.getElementsByTagName('a');
                    for (let j = 0; j < _headings.length; j++) {
                        
                        if (_headings[j].nextElementSibling === null) {
                            continue;
                        }
                        if (_headings[j] == headings[i]) {
                            continue;
                        }
                        _headings[j].nextElementSibling.style.display = 'none'    
                    }
                    
                    

                    if (headings[i].nextElementSibling === null) {
                        
                        
                        headings[i].parentNode.parentNode.style.display = 'block';
                    } else {
                        
                        
                        headings[i].nextElementSibling.style.display = 'block';
                    }

                    
                }
            }

        })


        

    

</script>
            </div>
            


<div class="simple-notice simple-notice-note" >
    <div class="simple-notice-title"><svg xmlns="http://www.w3.org/2000/svg" class="icon simple-notice-icon" viewBox="0 0 192 512"><path d="M176 432c0 44.11-35.89 80-80 80s-80-35.89-80-80 35.89-80 80-80 80 35.89 80 80zM25.26 25.2l13.6 272A24 24 0 0062.83 320h66.34a24 24 0 0023.97-22.8l13.6-272A24 24 0 00142.77 0H49.23a24 24 0 00-23.97 25.2z"/></svg></div><p>题意很简单，题目给出一个二进制可执行文件，要求通过反汇编等一系列破解六个密码。
密码都被封装到phase_1~phase_6六个函数中，如果输入错误则会引爆。</p>
<p>前置准备：先用如下指令把汇编输出到文件里，用vscode看看</p>
<p><code>objdump -d bomb &gt; bomb.asm</code></p>
<p>然后记住六个参数是：</p>
<p><code>rdi rsi rdx rcx r8 r9</code>，第七个参数就是通过栈来传递，返回参数在rax中</p></div>

<h1 id="1-phase_1">1. phase_1</h1>
<p>首先还是得看看汇编，其汇编如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">1</span><span><span style="color:#ed8796">0000000000400</span><span style="color:#8aadf4">ee0</span> <span style="color:#ed8796">&lt;</span><span style="color:#eed49f">phase_1</span><span style="color:#ed8796">&gt;</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">2</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">ee0:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">ec</span> <span style="color:#f5a97f">08</span>             <span style="color:#eed49f">sub</span>    <span style="color:#eed49f">$0x8</span>,<span style="color:#f4dbd6">%rsp</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">3</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">ee4:</span>   <span style="color:#8aadf4">be</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">40</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x402400</span>,<span style="color:#f4dbd6">%esi</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">4</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">ee9:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">4</span><span style="color:#eed49f">a</span> <span style="color:#f5a97f">04</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">401338</span> &lt;<span style="color:#eed49f">strings_not_equal</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">5</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">eee:</span>   <span style="color:#ed8796">85</span> <span style="color:#8aadf4">c0</span>                   <span style="color:#eed49f">test</span>   <span style="color:#f4dbd6">%eax</span>,<span style="color:#f4dbd6">%eax</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">6</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">ef0:</span>   <span style="color:#ed8796">74</span> <span style="color:#ed8796">05</span>                   <span style="color:#8aadf4">je</span>     <span style="color:#f5a97f">400ef7</span> &lt;<span style="color:#eed49f">phase_1</span>+<span style="color:#f5a97f">0x17</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">7</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">ef2:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">43</span> <span style="color:#f5a97f">05</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40143a</span> &lt;<span style="color:#eed49f">explode_bomb</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">8</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">ef7:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c4</span> <span style="color:#f5a97f">08</span>             <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x8</span>,<span style="color:#f4dbd6">%rsp</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">9</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">efb:</span>   <span style="color:#8aadf4">c3</span>                      <span style="color:#eed49f">retq</span>  
</span></span></code></pre></div><p>几乎是明牌了，第二行为函数开辟栈空间，mov指令把地址0x402400放到寄存器esi中，随后调用strings_not_equal这个函数（第一个第二个传入参数会被分别放到rdi和rsi两个寄存器中），由于知道x86把返回值放到rax寄存器中，后面会有一个判断结果的流程，再往后就是引爆炸弹了。
根据流程分析代码应该如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">1</span><span><span style="color:#ed8796">void</span> <span style="color:#8aadf4">phase_1</span>(<span style="color:#ed8796">char</span><span style="color:#91d7e3;font-weight:bold">*</span> input) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">2</span><span>    <span style="color:#ed8796">char</span><span style="color:#91d7e3;font-weight:bold">*</span> a <span style="color:#91d7e3;font-weight:bold">=</span> <span style="color:#a6da95">&#34;123123123&#34;</span>;    <span style="color:#6e738d;font-style:italic">// 这里只是代指，并非真正密码
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">3</span><span><span style="color:#6e738d;font-style:italic"></span>    <span style="color:#c6a0f6">if</span>(<span style="color:#8aadf4">strings_not_equal</span>(a, input)) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">4</span><span>        <span style="color:#8aadf4">explode_bomb</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">5</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">6</span><span>}
</span></span></code></pre></div><p>所以思路很明显了，直接<code>gdb ./bomb</code>，查看一下<code>0x402400</code>处内存就OK，具体如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">1</span><span><span style="color:#91d7e3;font-weight:bold">(</span>gdb<span style="color:#91d7e3;font-weight:bold">)</span> x/s 0x402400
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">2</span><span>0x402400:       <span style="color:#a6da95">&#34;Border relations with Canada have never been better.&#34;</span>
</span></span></code></pre></div><p>这里<code>x/s</code>表示按字符串查看指定位置内存（妈的之前不知道还一个个查表，真蠢）
最后在运行<code>bomb</code>输入密码即可，不带引号</p>
<h1 id="2-phase_2">2. phase_2</h1>
<p>这里直接给出注释：</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 1</span><span><span style="color:#ed8796">0000000000400</span><span style="color:#8aadf4">efc</span> <span style="color:#ed8796">&lt;</span><span style="color:#eed49f">phase_2</span><span style="color:#ed8796">&gt;</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 2</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">efc:</span>   <span style="color:#ed8796">55</span>                      <span style="color:#8aadf4">push</span>   <span style="color:#f4dbd6">%rbp</span>                     <span style="color:#6e738d;font-style:italic"># 压栈两个要用到的寄存器
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 3</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">efd:</span>   <span style="color:#ed8796">53</span>                      <span style="color:#8aadf4">push</span>   <span style="color:#f4dbd6">%rbx</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 4</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">efe:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">ec</span> <span style="color:#f5a97f">28</span>             <span style="color:#eed49f">sub</span>    <span style="color:#eed49f">$0x28</span>,<span style="color:#f4dbd6">%rsp</span>               <span style="color:#6e738d;font-style:italic"># 为函数开辟空间
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 5</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f02:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">89</span> <span style="color:#8aadf4">e6</span>                <span style="color:#eed49f">mov</span>    <span style="color:#f4dbd6">%rsp</span>,<span style="color:#f4dbd6">%rsi</span>                <span style="color:#6e738d;font-style:italic"># 把栈指针用作函数参数
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 6</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f05:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">52</span> <span style="color:#f5a97f">05</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40145c</span> &lt;<span style="color:#eed49f">read_six_numbers</span>&gt;<span style="color:#6e738d;font-style:italic"># 字面意义上从input中读取6个数字，可以想象数字被读取之后一定是存在栈上的（考虑到局部变量通过栈传递，以及上面一行把rsp传入该函数）
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 7</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f0a:</span>   <span style="color:#ed8796">83</span> <span style="color:#ed8796">3</span><span style="color:#8aadf4">c</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">01</span>             <span style="color:#eed49f">cmpl</span>   <span style="color:#eed49f">$0x1</span>,(<span style="color:#f4dbd6">%rsp</span>)              <span style="color:#6e738d;font-style:italic"># 比较rsp寄存器所指的数据与1大小，那么此时rsp所指的位置必然存在六个数字，这里将第一个数字和1比较。
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 8</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f0e:</span>   <span style="color:#ed8796">74</span> <span style="color:#ed8796">20</span>                   <span style="color:#8aadf4">je</span>     <span style="color:#f5a97f">400f30</span> &lt;<span style="color:#eed49f">phase_2</span>+<span style="color:#f5a97f">0x34</span>&gt;    <span style="color:#6e738d;font-style:italic"># 如果相等就跳转到30位置上
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 9</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f10:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">25</span> <span style="color:#f5a97f">05</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40143a</span> &lt;<span style="color:#eed49f">explode_bomb</span>&gt;    <span style="color:#6e738d;font-style:italic"># 否则就引爆
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">10</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f15:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#f5a97f">19</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">400f30</span> &lt;<span style="color:#eed49f">phase_2</span>+<span style="color:#f5a97f">0x34</span>&gt;    <span style="color:#6e738d;font-style:italic"># 引爆后再跳到30位置上
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">11</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f17:</span>   <span style="color:#ed8796">8</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">43</span> <span style="color:#eed49f">fc</span>                <span style="color:#eed49f">mov</span>    -<span style="color:#f5a97f">0x4</span>(<span style="color:#f4dbd6">%rbx</span>),<span style="color:#f4dbd6">%eax</span>          <span style="color:#6e738d;font-style:italic"># 将地址rbx-4内存处数据移动到eax，如果是第一次到此处，那此时eax中就是第一个数字，也就是1
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">12</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f1a:</span>   <span style="color:#ed8796">01</span> <span style="color:#8aadf4">c0</span>                   <span style="color:#eed49f">add</span>    <span style="color:#f4dbd6">%eax</span>,<span style="color:#f4dbd6">%eax</span>                <span style="color:#6e738d;font-style:italic"># 将eax乘以2
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">13</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f1c:</span>   <span style="color:#ed8796">39</span> <span style="color:#ed8796">03</span>                   <span style="color:#8aadf4">cmp</span>    <span style="color:#f4dbd6">%eax</span>,(<span style="color:#f4dbd6">%rbx</span>)              <span style="color:#6e738d;font-style:italic"># 将eax数据与rbx指向数据比较，如果是第一次到此处，那这行的意思就是把第一个数字的二倍和第二个数字比较
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">14</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f1e:</span>   <span style="color:#ed8796">74</span> <span style="color:#ed8796">05</span>                   <span style="color:#8aadf4">je</span>     <span style="color:#f5a97f">400f25</span> &lt;<span style="color:#eed49f">phase_2</span>+<span style="color:#f5a97f">0x29</span>&gt;    <span style="color:#6e738d;font-style:italic"># 相等跳到25位置，此时可以确认，要求是让第一个数字的两倍和第二个数字相等，依次递增
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">15</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f20:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">15</span> <span style="color:#f5a97f">05</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40143a</span> &lt;<span style="color:#eed49f">explode_bomb</span>&gt;    <span style="color:#6e738d;font-style:italic"># 否则引爆
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">16</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f25:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c3</span> <span style="color:#f5a97f">04</span>             <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x4</span>,<span style="color:#f4dbd6">%rbx</span>                <span style="color:#6e738d;font-style:italic"># 将rbx中数据加4，若第一次到此处，那此时指向第三个数字
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">17</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f29:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">39</span> <span style="color:#8aadf4">eb</span>                <span style="color:#eed49f">cmp</span>    <span style="color:#f4dbd6">%rbp</span>,<span style="color:#f4dbd6">%rbx</span>                <span style="color:#6e738d;font-style:italic"># 比较rbx和rbp中的地址数据，控制循环次数
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">18</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f2c:</span>   <span style="color:#ed8796">75</span> <span style="color:#8aadf4">e9</span>                   <span style="color:#eed49f">jne</span>    <span style="color:#f5a97f">400f17</span> &lt;<span style="color:#eed49f">phase_2</span>+<span style="color:#f5a97f">0x1b</span>&gt;    <span style="color:#6e738d;font-style:italic"># 如果不相等就跳转到17位置，继续循环
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">19</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f2e:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#f5a97f">0</span><span style="color:#eed49f">c</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">400f3c</span> &lt;<span style="color:#eed49f">phase_2</span>+<span style="color:#f5a97f">0x40</span>&gt;    <span style="color:#6e738d;font-style:italic"># 相等就跳转到3c位置，停止循环
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">20</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f30:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">5</span><span style="color:#eed49f">c</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">04</span>          <span style="color:#eed49f">lea</span>    <span style="color:#f5a97f">0x4</span>(<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%rbx</span>           <span style="color:#6e738d;font-style:italic"># 将0x4和rsp加起来将其中地址赋值给rbx，如果是第一次到此处，那么rbx保存的就是第二个数字的地址
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">21</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f35:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">6</span><span style="color:#eed49f">c</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">18</span>          <span style="color:#eed49f">lea</span>    <span style="color:#f5a97f">0x18</span>(<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%rbp</span>          <span style="color:#6e738d;font-style:italic"># 将0x18和rsp加起来将其中地址赋值给rbp，0x18=4*6=24，因此指向最后一个元素的末尾！
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">22</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f3a:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#eed49f">db</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">400f17</span> &lt;<span style="color:#eed49f">phase_2</span>+<span style="color:#f5a97f">0x1b</span>&gt;    <span style="color:#6e738d;font-style:italic"># 跳转到17位置
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">23</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f3c:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c4</span> <span style="color:#f5a97f">28</span>             <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x28</span>,<span style="color:#f4dbd6">%rsp</span>               <span style="color:#6e738d;font-style:italic"># 恢复栈
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">24</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f40:</span>   <span style="color:#ed8796">5</span><span style="color:#8aadf4">b</span>                      <span style="color:#eed49f">pop</span>    <span style="color:#f4dbd6">%rbx</span>                     <span style="color:#6e738d;font-style:italic"># 恢复寄存器
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">25</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f41:</span>   <span style="color:#ed8796">5</span><span style="color:#8aadf4">d</span>                      <span style="color:#eed49f">pop</span>    <span style="color:#f4dbd6">%rbp</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">26</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f42:</span>   <span style="color:#8aadf4">c3</span>                      <span style="color:#eed49f">retq</span>   
</span></span></code></pre></div><p>刚开始压栈和开辟空间没什么好说的，但需要注意这里开辟了<code>0x28</code>大小的空间，这相当的大，下一步把<code>rsp传给了rsi</code>，也就是第二个参数寄存器，从C代码中可以看到phase都只有一个参数，因此rsi没用上。</p>
<p>但后续调用<code>read_six_numbers</code>显然是用上了这个rsi，从字面意思来看，要从input读取六个数字，那返回值要放在哪里呢？<code>显然没有放在堆上，而是通过第二参数放在了其指向的地址上，也就是栈上！</code></p>
<p>下一步是将rsp所指的数据和1比较，显然rsp指向六个中的第一个，那第一个数字必然是1。后面跳转到指定位置上，具体的步骤是将rbx指向了下一个数字，将rbp指向了最后一个数字的末尾！随后继续跳转。</p>
<p>后面跳转到的是获取上一个数字并将其乘以2与自己比较，那很明显就是当前数字必须是前一个数字的两倍，随后跳转到循环的判断语句上，判断是否到达了循环次数！</p>
<p>由此可见类似的C代码应该是：</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 1</span><span><span style="color:#ed8796">void</span> <span style="color:#8aadf4">phase_2</span>(<span style="color:#ed8796">char</span> <span style="color:#91d7e3;font-weight:bold">*</span>input) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 2</span><span>    <span style="color:#ed8796">int</span> a[<span style="color:#f5a97f">6</span>];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 3</span><span>    <span style="color:#8aadf4">read_six_numbers</span>(input, a);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 4</span><span>    <span style="color:#c6a0f6">if</span> (a[<span style="color:#f5a97f">0</span>] <span style="color:#91d7e3;font-weight:bold">!=</span> <span style="color:#f5a97f">1</span>) <span style="color:#8aadf4">explode_bomb</span>(); 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 5</span><span>    <span style="color:#c6a0f6">for</span> (<span style="color:#ed8796">int</span> i <span style="color:#91d7e3;font-weight:bold">=</span> <span style="color:#f5a97f">1</span>; i <span style="color:#91d7e3;font-weight:bold">&lt;</span> <span style="color:#f5a97f">6</span>; i<span style="color:#91d7e3;font-weight:bold">++</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 6</span><span>        <span style="color:#c6a0f6">if</span>(a[i] <span style="color:#91d7e3;font-weight:bold">!=</span> <span style="color:#f5a97f">2</span> <span style="color:#91d7e3;font-weight:bold">*</span> a[i <span style="color:#91d7e3;font-weight:bold">-</span> <span style="color:#f5a97f">1</span>]) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 7</span><span>            <span style="color:#8aadf4">explode_bomb</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 8</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 9</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">10</span><span>}
</span></span></code></pre></div><p>所以显而易见，要输入的密码应该是<code>1 2 4 8 16 32 64</code></p>
<h1 id="3-phase_3">3. phase_3</h1>
<p>同样给出注释</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 1</span><span><span style="color:#ed8796">0000000000400</span><span style="color:#8aadf4">f43</span> <span style="color:#ed8796">&lt;</span><span style="color:#eed49f">phase_3</span><span style="color:#ed8796">&gt;</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 2</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f43:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">ec</span> <span style="color:#f5a97f">18</span>             <span style="color:#eed49f">sub</span>    <span style="color:#eed49f">$0x18</span>,<span style="color:#f4dbd6">%rsp</span>                   <span style="color:#6e738d;font-style:italic"># 预留空间
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 3</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f47:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">4</span><span style="color:#eed49f">c</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">0</span><span style="color:#eed49f">c</span>          <span style="color:#eed49f">lea</span>    <span style="color:#f5a97f">0xc</span>(<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%rcx</span>               <span style="color:#6e738d;font-style:italic"># 第四参数寄存器的值是rsp+12
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 4</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f4c:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">54</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">08</span>          <span style="color:#eed49f">lea</span>    <span style="color:#f5a97f">0x8</span>(<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%rdx</span>               <span style="color:#6e738d;font-style:italic"># 第三参数寄存器的值是rsp+8，猜想可能是获取数据
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 5</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f51:</span>   <span style="color:#8aadf4">be</span> <span style="color:#eed49f">cf</span> <span style="color:#f5a97f">25</span> <span style="color:#f5a97f">40</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x4025cf</span>,<span style="color:#f4dbd6">%esi</span>               <span style="color:#6e738d;font-style:italic"># 把某个地址的数据放到esi中了，而esi是第二个参数寄存器，32位，第一个参数寄存器已经放了input，从后面可知这里应该是format字符串
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 6</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f56:</span>   <span style="color:#8aadf4">b8</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x0</span>,<span style="color:#f4dbd6">%eax</span>                    <span style="color:#6e738d;font-style:italic"># 把0放到eax中，rax是返回值寄存器
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 7</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f5b:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">90</span> <span style="color:#eed49f">fc</span> <span style="color:#eed49f">ff</span> <span style="color:#eed49f">ff</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">400bf0</span> &lt;<span style="color:#eed49f">__isoc99_sscanf@plt</span>&gt; <span style="color:#6e738d;font-style:italic"># 调用sscanf函数，int sscanf(const char *str, const char *format, ...);
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 8</span><span><span style="color:#6e738d;font-style:italic"></span>                                                                        <span style="color:#6e738d;font-style:italic"># 猜想是sscanf(input, esi指向的字符串, 返回参数)，得gdb看一下format
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 9</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f60:</span>   <span style="color:#ed8796">83</span> <span style="color:#8aadf4">f8</span> <span style="color:#f5a97f">01</span>                <span style="color:#eed49f">cmp</span>    <span style="color:#eed49f">$0x1</span>,<span style="color:#f4dbd6">%eax</span>                    <span style="color:#6e738d;font-style:italic"># 此时eax返回值是解析成功了几个，从gdb中可以看出是两个整形参数
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">10</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f63:</span>   <span style="color:#ed8796">7</span><span style="color:#8aadf4">f</span> <span style="color:#f5a97f">05</span>                   <span style="color:#eed49f">jg</span>     <span style="color:#f5a97f">400f6a</span> &lt;<span style="color:#eed49f">phase_3</span>+<span style="color:#f5a97f">0x27</span>&gt;        <span style="color:#6e738d;font-style:italic"># 如果是eax&gt;1就跳转6a，否则爆炸
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">11</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f65:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#eed49f">d0</span> <span style="color:#f5a97f">04</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40143a</span> &lt;<span style="color:#eed49f">explode_bomb</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">12</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f6a:</span>   <span style="color:#ed8796">83</span> <span style="color:#ed8796">7</span><span style="color:#8aadf4">c</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">08</span> <span style="color:#f5a97f">07</span>          <span style="color:#eed49f">cmpl</span>   <span style="color:#eed49f">$0x7</span>,<span style="color:#f5a97f">0x8</span>(<span style="color:#f4dbd6">%rsp</span>)               <span style="color:#6e738d;font-style:italic"># 比较四个字节，比较rsp+8位置的数据，也就是第三个参数和0x7的关系
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">13</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f6f:</span>   <span style="color:#ed8796">77</span> <span style="color:#ed8796">3</span><span style="color:#8aadf4">c</span>                   <span style="color:#eed49f">ja</span>     <span style="color:#f5a97f">400fad</span> &lt;<span style="color:#eed49f">phase_3</span>+<span style="color:#f5a97f">0x6a</span>&gt;        <span style="color:#6e738d;font-style:italic"># 如果是大于就跳转ad位置，ad位置是爆炸，也就是说第三个参数不能大于7
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">14</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f71:</span>   <span style="color:#ed8796">8</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">44</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">08</span>             <span style="color:#eed49f">mov</span>    <span style="color:#f5a97f">0x8</span>(<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%eax</span>               <span style="color:#6e738d;font-style:italic"># 把第三参数放到eax中，假设第三参数是0，那就是跳转到0x402470处
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">15</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f75:</span>   <span style="color:#8aadf4">ff</span> <span style="color:#f5a97f">24</span> <span style="color:#eed49f">c5</span> <span style="color:#f5a97f">70</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">40</span> <span style="color:#f5a97f">00</span>    <span style="color:#eed49f">jmpq</span>   *<span style="color:#f5a97f">0x402470</span>(,<span style="color:#f4dbd6">%rax</span>,<span style="color:#f5a97f">8</span>)           <span style="color:#6e738d;font-style:italic"># 间接跳转0x402470内存处的地址，gdb看了，输入两个参数且第一个参数为0时是0x400f7c
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">16</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f7c:</span>   <span style="color:#8aadf4">b8</span> <span style="color:#eed49f">cf</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0xcf</span>,<span style="color:#f4dbd6">%eax</span>                   <span style="color:#6e738d;font-style:italic"># 覆盖eax为0xcf
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">17</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f81:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#f5a97f">3</span><span style="color:#eed49f">b</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">400fbe</span> &lt;<span style="color:#eed49f">phase_3</span>+<span style="color:#f5a97f">0x7b</span>&gt;        <span style="color:#6e738d;font-style:italic"># 跳转到be位置
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">18</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f83:</span>   <span style="color:#8aadf4">b8</span> <span style="color:#eed49f">c3</span> <span style="color:#f5a97f">02</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x2c3</span>,<span style="color:#f4dbd6">%eax</span>                 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">19</span><span>  <span style="color:#f5a97f">400</span><span style="color:#eed49f">f88</span>:   <span style="color:#eed49f">eb</span> <span style="color:#f5a97f">34</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">400fbe</span> &lt;<span style="color:#eed49f">phase_3</span>+<span style="color:#f5a97f">0x7b</span>&gt;        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">20</span><span>  <span style="color:#f5a97f">400</span><span style="color:#eed49f">f8a</span>:   <span style="color:#eed49f">b8</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">01</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x100</span>,<span style="color:#f4dbd6">%eax</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">21</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f8f:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#f5a97f">2</span><span style="color:#eed49f">d</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">400fbe</span> &lt;<span style="color:#eed49f">phase_3</span>+<span style="color:#f5a97f">0x7b</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">22</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f91:</span>   <span style="color:#8aadf4">b8</span> <span style="color:#f5a97f">85</span> <span style="color:#f5a97f">01</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x185</span>,<span style="color:#f4dbd6">%eax</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">23</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f96:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#f5a97f">26</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">400fbe</span> &lt;<span style="color:#eed49f">phase_3</span>+<span style="color:#f5a97f">0x7b</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">24</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f98:</span>   <span style="color:#8aadf4">b8</span> <span style="color:#eed49f">ce</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0xce</span>,<span style="color:#f4dbd6">%eax</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">25</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f9d:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#f5a97f">1</span><span style="color:#eed49f">f</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">400fbe</span> &lt;<span style="color:#eed49f">phase_3</span>+<span style="color:#f5a97f">0x7b</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">26</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">f9f:</span>   <span style="color:#8aadf4">b8</span> <span style="color:#eed49f">aa</span> <span style="color:#f5a97f">02</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x2aa</span>,<span style="color:#f4dbd6">%eax</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">27</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fa4:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#f5a97f">18</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">400fbe</span> &lt;<span style="color:#eed49f">phase_3</span>+<span style="color:#f5a97f">0x7b</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">28</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fa6:</span>   <span style="color:#8aadf4">b8</span> <span style="color:#f5a97f">47</span> <span style="color:#f5a97f">01</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x147</span>,<span style="color:#f4dbd6">%eax</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">29</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fab:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#f5a97f">11</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">400fbe</span> &lt;<span style="color:#eed49f">phase_3</span>+<span style="color:#f5a97f">0x7b</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">30</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fad:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">88</span> <span style="color:#f5a97f">04</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40143a</span> &lt;<span style="color:#eed49f">explode_bomb</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">31</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fb2:</span>   <span style="color:#8aadf4">b8</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x0</span>,<span style="color:#f4dbd6">%eax</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">32</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fb7:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#f5a97f">05</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">400fbe</span> &lt;<span style="color:#eed49f">phase_3</span>+<span style="color:#f5a97f">0x7b</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">33</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fb9:</span>   <span style="color:#8aadf4">b8</span> <span style="color:#f5a97f">37</span> <span style="color:#f5a97f">01</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x137</span>,<span style="color:#f4dbd6">%eax</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">34</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fbe:</span>   <span style="color:#ed8796">3</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">44</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">0</span><span style="color:#eed49f">c</span>             <span style="color:#eed49f">cmp</span>    <span style="color:#f5a97f">0xc</span>(<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%eax</span>               <span style="color:#6e738d;font-style:italic"># 比较第四参数和0xcf
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">35</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fc2:</span>   <span style="color:#ed8796">74</span> <span style="color:#ed8796">05</span>                   <span style="color:#8aadf4">je</span>     <span style="color:#f5a97f">400fc9</span> &lt;<span style="color:#eed49f">phase_3</span>+<span style="color:#f5a97f">0x86</span>&gt;        <span style="color:#6e738d;font-style:italic"># 如果相等就跳转到c9位置结束
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">36</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fc4:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">71</span> <span style="color:#f5a97f">04</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40143a</span> &lt;<span style="color:#eed49f">explode_bomb</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">37</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fc9:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c4</span> <span style="color:#f5a97f">18</span>             <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x18</span>,<span style="color:#f4dbd6">%rsp</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">38</span><span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fcd:</span>   <span style="color:#8aadf4">c3</span>                      <span style="color:#eed49f">retq</span>   
</span></span></code></pre></div><p>首先就搞了两个变量，显然是为了存返回数据，后续又马上调用了sscanf，查一下sscanf的函数说明：</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">1</span><span><span style="color:#ed8796">int</span> <span style="color:#8aadf4">sscanf</span>(<span style="color:#c6a0f6">const</span> <span style="color:#ed8796">char</span> <span style="color:#91d7e3;font-weight:bold">*</span>str, <span style="color:#c6a0f6">const</span> <span style="color:#ed8796">char</span> <span style="color:#91d7e3;font-weight:bold">*</span>format, ...);    <span style="color:#6e738d;font-style:italic">// int为成功获取参数个数
</span></span></span></code></pre></div><p>rsi是第二参数，可以看到第五行给了一个地址过去，用gdb查看一下发现是<code>%d %d</code>，由此不难推断出要按俩参数。</p>
<p>而前面搞的俩栈上变量显然是用来存储读取到的数据</p>
<p>eax获取解析了几个，后面如果<code>eax&gt;1</code>则继续执行，侧面验证了要按俩参数</p>
<p>后续又比较第一个参数和7，大于7就会爆炸，因此第一个参数不能大于7，后续往下，根据第一个参数是什么来实行间接跳转，这里我随便写个0，转到gdb看一下跳转地址，应该是一个类似switch的东西，随后直接算出来第二个参数是<code>0xcf即207</code></p>
<p>可以猜测一下C代码结构：</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 1</span><span><span style="color:#ed8796">void</span> <span style="color:#8aadf4">phase_3</span>(<span style="color:#ed8796">char</span><span style="color:#91d7e3;font-weight:bold">*</span> input){
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 2</span><span>    <span style="color:#ed8796">int</span> a, b;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 3</span><span>    <span style="color:#ed8796">int</span> res <span style="color:#91d7e3;font-weight:bold">=</span> <span style="color:#8aadf4">sscanf</span>(input, <span style="color:#a6da95">&#34;%d %d&#34;</span>, <span style="color:#91d7e3;font-weight:bold">&amp;</span>a, <span style="color:#91d7e3;font-weight:bold">&amp;</span>b);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 4</span><span>    <span style="color:#c6a0f6">if</span> (res <span style="color:#91d7e3;font-weight:bold">&lt;=</span> <span style="color:#f5a97f">1</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 5</span><span>        <span style="color:#8aadf4">explode_bomb</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 6</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 7</span><span>    <span style="color:#c6a0f6">if</span> (a <span style="color:#91d7e3;font-weight:bold">&gt;</span> <span style="color:#f5a97f">7</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 8</span><span>        <span style="color:#8aadf4">explode_bomb</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 9</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">10</span><span>    <span style="color:#c6a0f6">switch</span>(a) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">11</span><span>        <span style="color:#c6a0f6">case</span> <span style="color:#f5a97f">0</span><span style="color:#91d7e3;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">12</span><span>            <span style="color:#c6a0f6">if</span> (b <span style="color:#91d7e3;font-weight:bold">!=</span> <span style="color:#f5a97f">207</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">13</span><span>                <span style="color:#8aadf4">explode_bomb</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">14</span><span>            }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">15</span><span>            <span style="color:#c6a0f6">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">16</span><span>        <span style="color:#c6a0f6">case</span> <span style="color:#f5a97f">1</span><span style="color:#91d7e3;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">17</span><span>        ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">18</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">19</span><span>}
</span></span></code></pre></div><p>所以正确答案是<code>0 207</code></p>
<h1 id="4-phase_4">4. phase_4</h1>
<p>首先还是先看汇编：</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 1</span><span><span style="color:#ed8796">000000000040100</span><span style="color:#8aadf4">c</span> <span style="color:#ed8796">&lt;</span><span style="color:#eed49f">phase_4</span><span style="color:#ed8796">&gt;</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 2</span><span>  <span style="color:#ed8796">40100</span><span style="color:#91d7e3">c:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">ec</span> <span style="color:#f5a97f">18</span>             <span style="color:#eed49f">sub</span>    <span style="color:#eed49f">$0x18</span>,<span style="color:#f4dbd6">%rsp</span>                   <span style="color:#6e738d;font-style:italic"># 预留空间
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 3</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401010:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">4</span><span style="color:#eed49f">c</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">0</span><span style="color:#eed49f">c</span>          <span style="color:#eed49f">lea</span>    <span style="color:#f5a97f">0xc</span>(<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%rcx</span>               <span style="color:#6e738d;font-style:italic"># 准备第四参数
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 4</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401015:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">54</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">08</span>          <span style="color:#eed49f">lea</span>    <span style="color:#f5a97f">0x8</span>(<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%rdx</span>               <span style="color:#6e738d;font-style:italic"># 准备第三参数
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 5</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40101</span><span style="color:#91d7e3">a:</span>   <span style="color:#8aadf4">be</span> <span style="color:#eed49f">cf</span> <span style="color:#f5a97f">25</span> <span style="color:#f5a97f">40</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x4025cf</span>,<span style="color:#f4dbd6">%esi</span>               <span style="color:#6e738d;font-style:italic"># 第二参数，具体存的东西在0x4025cf处，和phase_3一样%d %d
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 6</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40101</span><span style="color:#91d7e3">f:</span>   <span style="color:#8aadf4">b8</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x0</span>,<span style="color:#f4dbd6">%eax</span>                    <span style="color:#6e738d;font-style:italic"># 清理eax
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 7</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401024:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#eed49f">c7</span> <span style="color:#eed49f">fb</span> <span style="color:#eed49f">ff</span> <span style="color:#eed49f">ff</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">400bf0</span> &lt;<span style="color:#eed49f">__isoc99_sscanf@plt</span>&gt; <span style="color:#6e738d;font-style:italic"># 调用sscanf
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 8</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401029:</span>   <span style="color:#ed8796">83</span> <span style="color:#8aadf4">f8</span> <span style="color:#f5a97f">02</span>                <span style="color:#eed49f">cmp</span>    <span style="color:#eed49f">$0x2</span>,<span style="color:#f4dbd6">%eax</span>                    <span style="color:#6e738d;font-style:italic"># 将成功获取参数个数与2比较
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 9</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40102</span><span style="color:#91d7e3">c:</span>   <span style="color:#ed8796">75</span> <span style="color:#ed8796">07</span>                   <span style="color:#8aadf4">jne</span>    <span style="color:#f5a97f">401035</span> &lt;<span style="color:#eed49f">phase_4</span>+<span style="color:#f5a97f">0x29</span>&gt;        <span style="color:#6e738d;font-style:italic"># 如果不等于就跳转35处爆炸
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">10</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40102</span><span style="color:#91d7e3">e:</span>   <span style="color:#ed8796">83</span> <span style="color:#ed8796">7</span><span style="color:#8aadf4">c</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">08</span> <span style="color:#f5a97f">0</span><span style="color:#eed49f">e</span>          <span style="color:#eed49f">cmpl</span>   <span style="color:#eed49f">$0xe</span>,<span style="color:#f5a97f">0x8</span>(<span style="color:#f4dbd6">%rsp</span>)               <span style="color:#6e738d;font-style:italic"># 此时是等于2的，将获取到的第三参数与0xe比较，即第一个数字
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">11</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401033:</span>   <span style="color:#ed8796">76</span> <span style="color:#ed8796">05</span>                   <span style="color:#8aadf4">jbe</span>    <span style="color:#f5a97f">40103a</span> &lt;<span style="color:#eed49f">phase_4</span>+<span style="color:#f5a97f">0x2e</span>&gt;        <span style="color:#6e738d;font-style:italic"># 如果第三参数&lt;=0xe就跳转3a处，否则就爆炸，所以第一个数字一定要小于等于0xe=14
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">12</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401035:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">04</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40143a</span> &lt;<span style="color:#eed49f">explode_bomb</span>&gt;        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">13</span><span>  <span style="color:#f5a97f">40103</span><span style="color:#eed49f">a</span>:   <span style="color:#eed49f">ba</span> <span style="color:#f5a97f">0</span><span style="color:#eed49f">e</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0xe</span>,<span style="color:#f4dbd6">%edx</span>                    <span style="color:#6e738d;font-style:italic"># 将0xe放入edx中，用作func4的第三参数
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">14</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40103</span><span style="color:#91d7e3">f:</span>   <span style="color:#8aadf4">be</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x0</span>,<span style="color:#f4dbd6">%esi</span>                    <span style="color:#6e738d;font-style:italic"># 将0放入esi中，用作func4的第二参数
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">15</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401044:</span>   <span style="color:#ed8796">8</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">7</span><span style="color:#eed49f">c</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">08</span>             <span style="color:#eed49f">mov</span>    <span style="color:#f5a97f">0x8</span>(<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%edi</span>               <span style="color:#6e738d;font-style:italic"># 获取第一个数字将其放入edi中，用作func4的第一参数
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">16</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401048:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">81</span> <span style="color:#eed49f">ff</span> <span style="color:#eed49f">ff</span> <span style="color:#eed49f">ff</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">400fce</span> &lt;<span style="color:#eed49f">func4</span>&gt;               <span style="color:#6e738d;font-style:italic"># 调用func4，这里不确定func4有几个参数，但在这个函数里面至少有三个，也有可能有四个
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">17</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40104</span><span style="color:#91d7e3">d:</span>   <span style="color:#ed8796">85</span> <span style="color:#8aadf4">c0</span>                   <span style="color:#eed49f">test</span>   <span style="color:#f4dbd6">%eax</span>,<span style="color:#f4dbd6">%eax</span>                    <span style="color:#6e738d;font-style:italic"># 测试返回值是否为0
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">18</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40104</span><span style="color:#91d7e3">f:</span>   <span style="color:#ed8796">75</span> <span style="color:#ed8796">07</span>                   <span style="color:#8aadf4">jne</span>    <span style="color:#f5a97f">401058</span> &lt;<span style="color:#eed49f">phase_4</span>+<span style="color:#f5a97f">0x4c</span>&gt;        <span style="color:#6e738d;font-style:italic"># 如果非0就跳转爆炸
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">19</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401051:</span>   <span style="color:#ed8796">83</span> <span style="color:#ed8796">7</span><span style="color:#8aadf4">c</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">0</span><span style="color:#eed49f">c</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">cmpl</span>   <span style="color:#eed49f">$0x0</span>,<span style="color:#f5a97f">0xc</span>(<span style="color:#f4dbd6">%rsp</span>)               <span style="color:#6e738d;font-style:italic"># 是0就把第二个数字与0比较
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">20</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401056:</span>   <span style="color:#ed8796">74</span> <span style="color:#ed8796">05</span>                   <span style="color:#8aadf4">je</span>     <span style="color:#f5a97f">40105d</span> &lt;<span style="color:#eed49f">phase_4</span>+<span style="color:#f5a97f">0x51</span>&gt;        <span style="color:#6e738d;font-style:italic"># 如果相等就结束，所以第二个数字必然为0
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">21</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401058:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#eed49f">dd</span> <span style="color:#f5a97f">03</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40143a</span> &lt;<span style="color:#eed49f">explode_bomb</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">22</span><span>  <span style="color:#ed8796">40105</span><span style="color:#91d7e3">d:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c4</span> <span style="color:#f5a97f">18</span>             <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x18</span>,<span style="color:#f4dbd6">%rsp</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">23</span><span>  <span style="color:#ed8796">401061:</span>   <span style="color:#8aadf4">c3</span>                      <span style="color:#eed49f">retq</span>   
</span></span></code></pre></div><p>可以看到，首先是准备参数，随后和phase3中一样从input中提取数字，gdb看一下也是%d %d，并且将获取成功的参数与2相比是否正确，随后检查第一个数字是否是小于14，如果是就调用func4，不是就爆炸，获取func4返回值看是否为0，是的话就比较第二个数字是否为0，是0就成功</p>
<p>所以显然第一个数字小于等于14，第二个数字为0</p>
<p>这里可以尝试一手0 0，再进func4分析，func4汇编如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 1</span><span><span style="color:#ed8796">0000000000400</span><span style="color:#8aadf4">fce</span> <span style="color:#ed8796">&lt;</span><span style="color:#eed49f">func4</span><span style="color:#ed8796">&gt;</span>:                                           <span style="color:#6e738d;font-style:italic"># rdi rsi rdx，第一次调用分别为: 第一个数字，0，0xe=14
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 2</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fce:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">ec</span> <span style="color:#f5a97f">08</span>             <span style="color:#eed49f">sub</span>    <span style="color:#eed49f">$0x8</span>,<span style="color:#f4dbd6">%rsp</span>                <span style="color:#6e738d;font-style:italic"># 预留空间
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 3</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fd2:</span>   <span style="color:#ed8796">89</span> <span style="color:#8aadf4">d0</span>                   <span style="color:#eed49f">mov</span>    <span style="color:#f4dbd6">%edx</span>,<span style="color:#f4dbd6">%eax</span>                <span style="color:#6e738d;font-style:italic"># 把第三参数存到eax中  eax = edx = 14
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 4</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fd4:</span>   <span style="color:#ed8796">29</span> <span style="color:#8aadf4">f0</span>                   <span style="color:#eed49f">sub</span>    <span style="color:#f4dbd6">%esi</span>,<span style="color:#f4dbd6">%eax</span>                <span style="color:#6e738d;font-style:italic"># 把eax中的第三参数减去第二参数 eax = eax - esi = 14
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 5</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fd6:</span>   <span style="color:#ed8796">89</span> <span style="color:#8aadf4">c1</span>                   <span style="color:#eed49f">mov</span>    <span style="color:#f4dbd6">%eax</span>,<span style="color:#f4dbd6">%ecx</span>                <span style="color:#6e738d;font-style:italic"># 把eax中减去第二参数的第三参数放到ecx寄存器里，从此处基本确定这个函数有三个参数 ecx = eax = 14
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 6</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fd8:</span>   <span style="color:#8aadf4">c1</span> <span style="color:#eed49f">e9</span> <span style="color:#f5a97f">1</span><span style="color:#eed49f">f</span>                <span style="color:#eed49f">shr</span>    <span style="color:#eed49f">$0x1f</span>,<span style="color:#f4dbd6">%ecx</span>               <span style="color:#6e738d;font-style:italic"># 逻辑右移0x1f个位置存到ecx中 ecx&gt;&gt;0x1f（相当于取最高位的0或者1） ecx = 0
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 7</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fdb:</span>   <span style="color:#ed8796">01</span> <span style="color:#8aadf4">c8</span>                   <span style="color:#eed49f">add</span>    <span style="color:#f4dbd6">%ecx</span>,<span style="color:#f4dbd6">%eax</span>                <span style="color:#6e738d;font-style:italic"># 把ecx和eax相加存到eax中     eax = ecx + eax     eax = 14
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 8</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fdd:</span>   <span style="color:#8aadf4">d1</span> <span style="color:#eed49f">f8</span>                   <span style="color:#eed49f">sar</span>    <span style="color:#f4dbd6">%eax</span>                     <span style="color:#6e738d;font-style:italic"># 算术右移但没写移几位，这里debug了一下发现是除以2，所以应该是取默认值为1，即右移一位         
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 9</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fdf:</span>   <span style="color:#ed8796">8</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">0</span><span style="color:#eed49f">c</span> <span style="color:#f5a97f">30</span>                <span style="color:#eed49f">lea</span>    (<span style="color:#f4dbd6">%rax</span>,<span style="color:#f4dbd6">%rsi</span>,<span style="color:#f5a97f">1</span>),<span style="color:#f4dbd6">%ecx</span>       <span style="color:#6e738d;font-style:italic"># 把rax+rsi赋值给ecx
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">10</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fe2:</span>   <span style="color:#ed8796">39</span> <span style="color:#8aadf4">f9</span>                   <span style="color:#eed49f">cmp</span>    <span style="color:#f4dbd6">%edi</span>,<span style="color:#f4dbd6">%ecx</span>                <span style="color:#6e738d;font-style:italic"># 比较edi和ecx
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">11</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fe4:</span>   <span style="color:#ed8796">7</span><span style="color:#8aadf4">e</span> <span style="color:#f5a97f">0</span><span style="color:#eed49f">c</span>                   <span style="color:#eed49f">jle</span>    <span style="color:#f5a97f">400ff2</span> &lt;<span style="color:#eed49f">func4</span>+<span style="color:#f5a97f">0x24</span>&gt;      <span style="color:#6e738d;font-style:italic"># 如果ecx &lt;= edi就跳转f2位置
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">12</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fe6:</span>   <span style="color:#ed8796">8</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">51</span> <span style="color:#eed49f">ff</span>                <span style="color:#eed49f">lea</span>    -<span style="color:#f5a97f">0x1</span>(<span style="color:#f4dbd6">%rcx</span>),<span style="color:#f4dbd6">%edx</span>          <span style="color:#6e738d;font-style:italic"># 否则就将rcx-1赋值给edx
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">13</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fe9:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#eed49f">e0</span> <span style="color:#eed49f">ff</span> <span style="color:#eed49f">ff</span> <span style="color:#eed49f">ff</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">400fce</span> &lt;<span style="color:#eed49f">func4</span>&gt;           <span style="color:#6e738d;font-style:italic"># 递归调用
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">14</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">fee:</span>   <span style="color:#ed8796">01</span> <span style="color:#8aadf4">c0</span>                   <span style="color:#eed49f">add</span>    <span style="color:#f4dbd6">%eax</span>,<span style="color:#f4dbd6">%eax</span>                <span style="color:#6e738d;font-style:italic"># 把返回值eax * 2   相当于return 2 * func4()
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">15</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">ff0:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#f5a97f">15</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">401007</span> &lt;<span style="color:#eed49f">func4</span>+<span style="color:#f5a97f">0x39</span>&gt;      <span style="color:#6e738d;font-style:italic"># 结束
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">16</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">ff2:</span>   <span style="color:#8aadf4">b8</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x0</span>,<span style="color:#f4dbd6">%eax</span>                <span style="color:#6e738d;font-style:italic"># 把0赋值给eax
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">17</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">ff7:</span>   <span style="color:#ed8796">39</span> <span style="color:#8aadf4">f9</span>                   <span style="color:#eed49f">cmp</span>    <span style="color:#f4dbd6">%edi</span>,<span style="color:#f4dbd6">%ecx</span>                <span style="color:#6e738d;font-style:italic"># 比较ecx和edi
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">18</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">ff9:</span>   <span style="color:#ed8796">7</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">0</span><span style="color:#eed49f">c</span>                   <span style="color:#eed49f">jge</span>    <span style="color:#f5a97f">401007</span> &lt;<span style="color:#eed49f">func4</span>+<span style="color:#f5a97f">0x39</span>&gt;      <span style="color:#6e738d;font-style:italic"># 若 ecx&gt;=edi，就跳转07位置
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">19</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">ffb:</span>   <span style="color:#ed8796">8</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">71</span> <span style="color:#f5a97f">01</span>                <span style="color:#eed49f">lea</span>    <span style="color:#f5a97f">0x1</span>(<span style="color:#f4dbd6">%rcx</span>),<span style="color:#f4dbd6">%esi</span>           <span style="color:#6e738d;font-style:italic"># 否则把rcx+1赋值给esi
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">20</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">400</span><span style="color:#91d7e3">ffe:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#eed49f">cb</span> <span style="color:#eed49f">ff</span> <span style="color:#eed49f">ff</span> <span style="color:#eed49f">ff</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">400fce</span> &lt;<span style="color:#eed49f">func4</span>&gt;           <span style="color:#6e738d;font-style:italic"># 递归调用
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">21</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401003:</span>   <span style="color:#ed8796">8</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">44</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">01</span>             <span style="color:#eed49f">lea</span>    <span style="color:#f5a97f">0x1</span>(<span style="color:#f4dbd6">%rax</span>,<span style="color:#f4dbd6">%rax</span>,<span style="color:#f5a97f">1</span>),<span style="color:#f4dbd6">%eax</span>    <span style="color:#6e738d;font-style:italic"># 相当于返回 2 * eax + 1  相当于return 2 * func4() + 1
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">22</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401007:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c4</span> <span style="color:#f5a97f">08</span>             <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x8</span>,<span style="color:#f4dbd6">%rsp</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">23</span><span>  <span style="color:#ed8796">40100</span><span style="color:#91d7e3">b:</span>   <span style="color:#8aadf4">c3</span>                      <span style="color:#eed49f">retq</span>
</span></span></code></pre></div><p>显然是个很坑的递归，可以一行行将其换成C如下，注意gdb里尝试的sar %eax不带移动位数就默认是移动1位，最终可以知道递归代码如下。一通分析发现第一个数字是0。</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 1</span><span><span style="color:#6e738d;font-style:italic">// 第一次进入分别为：第一个数字，0，14
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 2</span><span><span style="color:#6e738d;font-style:italic"></span><span style="color:#ed8796">int</span> <span style="color:#8aadf4">func4</span>(<span style="color:#ed8796">int</span> a, <span style="color:#ed8796">int</span> b, <span style="color:#ed8796">int</span> c) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 3</span><span>    <span style="color:#ed8796">int</span> tmp1 <span style="color:#91d7e3;font-weight:bold">=</span> c <span style="color:#91d7e3;font-weight:bold">-</span> b;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 4</span><span>    <span style="color:#ed8796">int</span> tmp2 <span style="color:#91d7e3;font-weight:bold">=</span> tmp1 <span style="color:#91d7e3;font-weight:bold">&gt;&gt;</span> <span style="color:#f5a97f">31</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 5</span><span>    tmp1 <span style="color:#91d7e3;font-weight:bold">=</span> tmp2 <span style="color:#91d7e3;font-weight:bold">+</span> tmp1;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 6</span><span>    tmp1 <span style="color:#91d7e3;font-weight:bold">=</span> tmp1 <span style="color:#91d7e3;font-weight:bold">/</span> <span style="color:#f5a97f">2</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 7</span><span>    tmp2 <span style="color:#91d7e3;font-weight:bold">=</span> tmp1 <span style="color:#91d7e3;font-weight:bold">+</span> b;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 8</span><span>    <span style="color:#c6a0f6">if</span> (tmp2 <span style="color:#91d7e3;font-weight:bold">&lt;=</span> a) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 9</span><span>       tmp1 <span style="color:#91d7e3;font-weight:bold">=</span> <span style="color:#f5a97f">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">10</span><span>       <span style="color:#c6a0f6">if</span> (tmp2 <span style="color:#91d7e3;font-weight:bold">&gt;=</span> a) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">11</span><span>           <span style="color:#c6a0f6">return</span> <span style="color:#f5a97f">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">12</span><span>       } <span style="color:#c6a0f6">else</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">13</span><span>           b <span style="color:#91d7e3;font-weight:bold">=</span> tmp2 <span style="color:#91d7e3;font-weight:bold">+</span> <span style="color:#f5a97f">1</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">14</span><span>           <span style="color:#c6a0f6">return</span> <span style="color:#f5a97f">2</span> <span style="color:#91d7e3;font-weight:bold">*</span> <span style="color:#8aadf4">func4</span>(a, b, c) <span style="color:#91d7e3;font-weight:bold">+</span> <span style="color:#f5a97f">1</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">15</span><span>       }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">16</span><span>    } <span style="color:#c6a0f6">else</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">17</span><span>        c <span style="color:#91d7e3;font-weight:bold">=</span> tmp2 <span style="color:#91d7e3;font-weight:bold">-</span> <span style="color:#f5a97f">1</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">18</span><span>        <span style="color:#c6a0f6">return</span> <span style="color:#f5a97f">2</span> <span style="color:#91d7e3;font-weight:bold">*</span> <span style="color:#8aadf4">func4</span>(a, b, c);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">19</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">20</span><span>}
</span></span></code></pre></div><p>因此<code>第一个密码是0，第二个密码也是0</code>。</p>
<h1 id="5-phase_5">5. phase_5</h1>
<p>老规矩查看汇编：</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 1</span><span><span style="color:#ed8796">0000000000401062</span> <span style="color:#ed8796">&lt;</span><span style="color:#8aadf4">phase_5</span><span style="color:#ed8796">&gt;</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 2</span><span>  <span style="color:#ed8796">401062:</span>   <span style="color:#ed8796">53</span>                      <span style="color:#8aadf4">push</span>   <span style="color:#f4dbd6">%rbx</span>                         <span style="color:#6e738d;font-style:italic"># 后面要用到rbx，压栈
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 3</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401063:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">ec</span> <span style="color:#f5a97f">20</span>             <span style="color:#eed49f">sub</span>    <span style="color:#eed49f">$0x20</span>,<span style="color:#f4dbd6">%rsp</span>                   <span style="color:#6e738d;font-style:italic"># 开辟空间
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 4</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401067:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">89</span> <span style="color:#8aadf4">fb</span>                <span style="color:#eed49f">mov</span>    <span style="color:#f4dbd6">%rdi</span>,<span style="color:#f4dbd6">%rbx</span>                    <span style="color:#6e738d;font-style:italic"># 把input放到rbx中。rbx和rdi都指向input
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 5</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40106</span><span style="color:#91d7e3">a:</span>   <span style="color:#ed8796">64</span> <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">04</span> <span style="color:#f5a97f">25</span> <span style="color:#f5a97f">28</span> <span style="color:#f5a97f">00</span>    <span style="color:#eed49f">mov</span>    <span style="color:#f4dbd6">%fs</span>:<span style="color:#f5a97f">0x28</span>,<span style="color:#f4dbd6">%rax</span>                <span style="color:#6e738d;font-style:italic"># ？似乎是把什么玩意放到rax中
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 6</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401071:</span>   <span style="color:#ed8796">00</span> <span style="color:#ed8796">00</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 7</span><span>  <span style="color:#ed8796">401073:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">89</span> <span style="color:#ed8796">44</span> <span style="color:#ed8796">24</span> <span style="color:#ed8796">18</span>          <span style="color:#8aadf4">mov</span>    <span style="color:#f4dbd6">%rax</span>,<span style="color:#f5a97f">0x18</span>(<span style="color:#f4dbd6">%rsp</span>)              <span style="color:#6e738d;font-style:italic"># 把rax寄存器的数据放到栈中，也就是金丝雀值
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 8</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401078:</span>   <span style="color:#ed8796">31</span> <span style="color:#8aadf4">c0</span>                   <span style="color:#eed49f">xor</span>    <span style="color:#f4dbd6">%eax</span>,<span style="color:#f4dbd6">%eax</span>                    <span style="color:#6e738d;font-style:italic"># 将eax清零
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 9</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40107</span><span style="color:#91d7e3">a:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">9</span><span style="color:#eed49f">c</span> <span style="color:#f5a97f">02</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40131b</span> &lt;<span style="color:#eed49f">string_length</span>&gt;       <span style="color:#6e738d;font-style:italic"># 显然是获取字符串长度，将结果返回到eax中
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">10</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40107</span><span style="color:#91d7e3">f:</span>   <span style="color:#ed8796">83</span> <span style="color:#8aadf4">f8</span> <span style="color:#f5a97f">06</span>                <span style="color:#eed49f">cmp</span>    <span style="color:#eed49f">$0x6</span>,<span style="color:#f4dbd6">%eax</span>                    <span style="color:#6e738d;font-style:italic"># 比较字符串长度和6
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">11</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401082:</span>   <span style="color:#ed8796">74</span> <span style="color:#ed8796">4</span><span style="color:#8aadf4">e</span>                   <span style="color:#eed49f">je</span>     <span style="color:#f5a97f">4010d2</span> &lt;<span style="color:#eed49f">phase_5</span>+<span style="color:#f5a97f">0x70</span>&gt;        <span style="color:#6e738d;font-style:italic"># 如果相等就跳转d2位置，也就是说字符串长度得是6
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">12</span><span><span style="color:#6e738d;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">13</span><span>  <span style="color:#ed8796">401084:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#eed49f">b1</span> <span style="color:#f5a97f">03</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40143a</span> &lt;<span style="color:#eed49f">explode_bomb</span>&gt;        <span style="color:#6e738d;font-style:italic"># 否则爆炸
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">14</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401089:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#f5a97f">47</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">4010d2</span> &lt;<span style="color:#eed49f">phase_5</span>+<span style="color:#f5a97f">0x70</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">16</span><span>  <span style="color:#ed8796">40108</span><span style="color:#91d7e3">b:</span>   <span style="color:#ed8796">0</span><span style="color:#8aadf4">f</span> <span style="color:#eed49f">b6</span> <span style="color:#f5a97f">0</span><span style="color:#eed49f">c</span> <span style="color:#f5a97f">03</span>             <span style="color:#eed49f">movzbl</span> (<span style="color:#f4dbd6">%rbx</span>,<span style="color:#f4dbd6">%rax</span>,<span style="color:#f5a97f">1</span>),<span style="color:#f4dbd6">%ecx</span>           <span style="color:#6e738d;font-style:italic"># 将rbx+rax所指向的数据放到ecx中，rbx指向input，rax从0到5，也就是第一个字符
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">17</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40108</span><span style="color:#91d7e3">f:</span>   <span style="color:#ed8796">88</span> <span style="color:#ed8796">0</span><span style="color:#8aadf4">c</span> <span style="color:#f5a97f">24</span>                <span style="color:#eed49f">mov</span>    <span style="color:#f4dbd6">%cl</span>,(<span style="color:#f4dbd6">%rsp</span>)                   <span style="color:#6e738d;font-style:italic"># 将该字符压入栈上
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">18</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401092:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">14</span> <span style="color:#f5a97f">24</span>             <span style="color:#eed49f">mov</span>    (<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%rdx</span>                  <span style="color:#6e738d;font-style:italic"># 把该字符放入rdx中
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">19</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401096:</span>   <span style="color:#ed8796">83</span> <span style="color:#8aadf4">e2</span> <span style="color:#f5a97f">0</span><span style="color:#eed49f">f</span>                <span style="color:#eed49f">and</span>    <span style="color:#eed49f">$0xf</span>,<span style="color:#f4dbd6">%edx</span>                    <span style="color:#6e738d;font-style:italic"># 0xf与第一个字符做与操作，再把结果存到edx中，相当于只保留低4位
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">20</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401099:</span>   <span style="color:#ed8796">0</span><span style="color:#8aadf4">f</span> <span style="color:#eed49f">b6</span> <span style="color:#f5a97f">92</span> <span style="color:#eed49f">b0</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">40</span> <span style="color:#f5a97f">00</span>    <span style="color:#eed49f">movzbl</span> <span style="color:#f5a97f">0x4024b0</span>(<span style="color:#f4dbd6">%rdx</span>),<span style="color:#f4dbd6">%edx</span>          <span style="color:#6e738d;font-style:italic"># 再把保留低4位的值 + 0x4024b0所指向的数据放回edx中，gdb查看一手
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">21</span><span><span style="color:#6e738d;font-style:italic"></span>                                                                        <span style="color:#6e738d;font-style:italic"># 查看结果如下：maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">22</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">a0:</span>   <span style="color:#ed8796">88</span> <span style="color:#ed8796">54</span> <span style="color:#ed8796">04</span> <span style="color:#ed8796">10</span>             <span style="color:#8aadf4">mov</span>    <span style="color:#f4dbd6">%dl</span>,<span style="color:#f5a97f">0x10</span>(<span style="color:#f4dbd6">%rsp</span>,<span style="color:#f4dbd6">%rax</span>,<span style="color:#f5a97f">1</span>)        <span style="color:#6e738d;font-style:italic"># 把获取到的字符放到，0x10+rsp+rax所指向的地址，而rax从0到5，因此放入的位置是rsp+0x10到rsp+0x15
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">23</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">a4:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c0</span> <span style="color:#f5a97f">01</span>             <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x1</span>,<span style="color:#f4dbd6">%rax</span>                    <span style="color:#6e738d;font-style:italic"># 把rax+1
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">24</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">a8:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">f8</span> <span style="color:#f5a97f">06</span>             <span style="color:#eed49f">cmp</span>    <span style="color:#eed49f">$0x6</span>,<span style="color:#f4dbd6">%rax</span>                    <span style="color:#6e738d;font-style:italic"># 比较rax和6的大小
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">25</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">ac:</span>   <span style="color:#ed8796">75</span> <span style="color:#8aadf4">dd</span>                   <span style="color:#eed49f">jne</span>    <span style="color:#f5a97f">40108b</span> &lt;<span style="color:#eed49f">phase_5</span>+<span style="color:#f5a97f">0x29</span>&gt;        <span style="color:#6e738d;font-style:italic"># 如果不相等就回退到8b位置，所以这是个循环
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">26</span><span><span style="color:#6e738d;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">27</span><span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">ae:</span>   <span style="color:#8aadf4">c6</span> <span style="color:#f5a97f">44</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">16</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">movb</span>   <span style="color:#eed49f">$0x0</span>,<span style="color:#f5a97f">0x16</span>(<span style="color:#f4dbd6">%rsp</span>)              <span style="color:#6e738d;font-style:italic"># 相等就把栈上0x16位置赋值为0，相当于结束符
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">28</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">b3:</span>   <span style="color:#8aadf4">be</span> <span style="color:#f5a97f">5</span><span style="color:#eed49f">e</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">40</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x40245e</span>,<span style="color:#f4dbd6">%esi</span>               <span style="color:#6e738d;font-style:italic"># 把0x40245e赋值给%esi，gdb查看了一下发现是：flyers
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">29</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">b8:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">7</span><span style="color:#eed49f">c</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">10</span>          <span style="color:#eed49f">lea</span>    <span style="color:#f5a97f">0x10</span>(<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%rdi</span>              <span style="color:#6e738d;font-style:italic"># 把rsp + 0x10赋值给rdi
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">30</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">bd:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">76</span> <span style="color:#f5a97f">02</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">401338</span> &lt;<span style="color:#eed49f">strings_not_equal</span>&gt;   <span style="color:#6e738d;font-style:italic"># 调用函数，显然有俩参数
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">31</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">c2:</span>   <span style="color:#ed8796">85</span> <span style="color:#8aadf4">c0</span>                   <span style="color:#eed49f">test</span>   <span style="color:#f4dbd6">%eax</span>,<span style="color:#f4dbd6">%eax</span>                    <span style="color:#6e738d;font-style:italic"># 比较返回值是否相等
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">32</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">c4:</span>   <span style="color:#ed8796">74</span> <span style="color:#ed8796">13</span>                   <span style="color:#8aadf4">je</span>     <span style="color:#f5a97f">4010d9</span> &lt;<span style="color:#eed49f">phase_5</span>+<span style="color:#f5a97f">0x77</span>&gt;        <span style="color:#6e738d;font-style:italic"># 如果相等就跳转到d9位置结束
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">33</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">c6:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">6</span><span style="color:#eed49f">f</span> <span style="color:#f5a97f">03</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40143a</span> &lt;<span style="color:#eed49f">explode_bomb</span>&gt;        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">34</span><span>  <span style="color:#f5a97f">4010</span><span style="color:#eed49f">cb</span>:   <span style="color:#f5a97f">0</span><span style="color:#eed49f">f</span> <span style="color:#f5a97f">1</span><span style="color:#eed49f">f</span> <span style="color:#f5a97f">44</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">nopl</span>   <span style="color:#f5a97f">0x0</span>(<span style="color:#f4dbd6">%rax</span>,<span style="color:#f4dbd6">%rax</span>,<span style="color:#f5a97f">1</span>)             <span style="color:#6e738d;font-style:italic"># 无用
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">35</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">d0:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#f5a97f">07</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">4010d9</span> &lt;<span style="color:#eed49f">phase_5</span>+<span style="color:#f5a97f">0x77</span>&gt;      
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">36</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">37</span><span>  <span style="color:#f5a97f">4010</span><span style="color:#eed49f">d2</span>:   <span style="color:#eed49f">b8</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x0</span>,<span style="color:#f4dbd6">%eax</span>                    <span style="color:#6e738d;font-style:italic"># 将eax置零
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">38</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">d7:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#eed49f">b2</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">40108b</span> &lt;<span style="color:#eed49f">phase_5</span>+<span style="color:#f5a97f">0x29</span>&gt;        <span style="color:#6e738d;font-style:italic"># 跳转到8b位置
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">39</span><span><span style="color:#6e738d;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">40</span><span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">d9:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">44</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">18</span>          <span style="color:#eed49f">mov</span>    <span style="color:#f5a97f">0x18</span>(<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%rax</span>              <span style="color:#6e738d;font-style:italic"># 把rax寄存器的数据恢复
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">41</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">de:</span>   <span style="color:#ed8796">64</span> <span style="color:#ed8796">48</span> <span style="color:#ed8796">33</span> <span style="color:#ed8796">04</span> <span style="color:#ed8796">25</span> <span style="color:#ed8796">28</span> <span style="color:#ed8796">00</span>    <span style="color:#8aadf4">xor</span>    <span style="color:#f4dbd6">%fs</span>:<span style="color:#f5a97f">0x28</span>,<span style="color:#f4dbd6">%rax</span>                <span style="color:#6e738d;font-style:italic"># 比较金丝雀值
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">42</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">e5:</span>   <span style="color:#ed8796">00</span> <span style="color:#ed8796">00</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">43</span><span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">e7:</span>   <span style="color:#ed8796">74</span> <span style="color:#ed8796">05</span>                   <span style="color:#8aadf4">je</span>     <span style="color:#f5a97f">4010ee</span> &lt;<span style="color:#eed49f">phase_5</span>+<span style="color:#f5a97f">0x8c</span>&gt;        <span style="color:#6e738d;font-style:italic"># 如果相等就跳出，否则就继续
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">44</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">e9:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">42</span> <span style="color:#eed49f">fa</span> <span style="color:#eed49f">ff</span> <span style="color:#eed49f">ff</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">400b30</span> &lt;<span style="color:#eed49f">__stack_chk_fail@plt</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">45</span><span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">ee:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c4</span> <span style="color:#f5a97f">20</span>             <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x20</span>,<span style="color:#f4dbd6">%rsp</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">46</span><span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">f2:</span>   <span style="color:#ed8796">5</span><span style="color:#8aadf4">b</span>                      <span style="color:#eed49f">pop</span>    <span style="color:#f4dbd6">%rbx</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">47</span><span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">f3:</span>   <span style="color:#8aadf4">c3</span>                      <span style="color:#eed49f">retq</span>   
</span></span></code></pre></div><p>这题倒也简单，一看就知道是个循环，主要代码分为三部分：</p>
<ol>
<li>判断输入字符串的长度，从上面可以看出，如果不是6个字符就会爆炸</li>
<li>循环六个字符的低四位，并以此为索引从内存中找到六个对应字符，也就是从那一大串中找，并把六个对应字符存到栈上</li>
<li>将栈上六个字符与另外六个字符（<code>flyers</code>）相比较，如果不同就爆炸！
以第一个字符f为例，要找到这个字符，偏移量必须为9，大小写的I都可以做到，后续按照规律分别可以找到：<code>IONEFG</code>，大小写皆可，哪怕不是这些字符都OK，只要是ascii码低四位偏移量能够找到目标字符即可。</li>
</ol>
<h1 id="6-phase_6">6. phase_6</h1>
<p>这一关比较难，分段分析：</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 1</span><span><span style="color:#ed8796">00000000004010</span><span style="color:#8aadf4">f4</span> <span style="color:#ed8796">&lt;</span><span style="color:#eed49f">phase_6</span><span style="color:#ed8796">&gt;</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 2</span><span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">f4:</span>   <span style="color:#ed8796">41</span> <span style="color:#ed8796">56</span>                   <span style="color:#8aadf4">push</span>   <span style="color:#f4dbd6">%r14</span>                 <span style="color:#6e738d;font-style:italic"># 压栈一些寄存器
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 3</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">f6:</span>   <span style="color:#ed8796">41</span> <span style="color:#ed8796">55</span>                   <span style="color:#8aadf4">push</span>   <span style="color:#f4dbd6">%r13</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 4</span><span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">f8:</span>   <span style="color:#ed8796">41</span> <span style="color:#ed8796">54</span>                   <span style="color:#8aadf4">push</span>   <span style="color:#f4dbd6">%r12</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 5</span><span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">fa:</span>   <span style="color:#ed8796">55</span>                      <span style="color:#8aadf4">push</span>   <span style="color:#f4dbd6">%rbp</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 6</span><span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">fb:</span>   <span style="color:#ed8796">53</span>                      <span style="color:#8aadf4">push</span>   <span style="color:#f4dbd6">%rbx</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 7</span><span>  <span style="color:#ed8796">4010</span><span style="color:#91d7e3">fc:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">ec</span> <span style="color:#f5a97f">50</span>             <span style="color:#eed49f">sub</span>    <span style="color:#eed49f">$0x50</span>,<span style="color:#f4dbd6">%rsp</span>           <span style="color:#6e738d;font-style:italic"># 保留一段栈用于该函数
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 8</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401100:</span>   <span style="color:#ed8796">49</span> <span style="color:#ed8796">89</span> <span style="color:#8aadf4">e5</span>                <span style="color:#eed49f">mov</span>    <span style="color:#f4dbd6">%rsp</span>,<span style="color:#f4dbd6">%r13</span>            <span style="color:#6e738d;font-style:italic"># 把rsp存到r13中，r13= rsp
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 9</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401103:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">89</span> <span style="color:#8aadf4">e6</span>                <span style="color:#eed49f">mov</span>    <span style="color:#f4dbd6">%rsp</span>,<span style="color:#f4dbd6">%rsi</span>            <span style="color:#6e738d;font-style:italic"># 再把rsp存到rsi中
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">10</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401106:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">51</span> <span style="color:#f5a97f">03</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40145c</span> &lt;<span style="color:#eed49f">read_six_numbers</span>&gt; <span style="color:#6e738d;font-style:italic"># rdi是input，rsi是rsp，所以是从input中读取六个数字到栈上
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">11</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40110</span><span style="color:#91d7e3">b:</span>   <span style="color:#ed8796">49</span> <span style="color:#ed8796">89</span> <span style="color:#8aadf4">e6</span>                <span style="color:#eed49f">mov</span>    <span style="color:#f4dbd6">%rsp</span>,<span style="color:#f4dbd6">%r14</span>            <span style="color:#6e738d;font-style:italic"># 把rsp存到r14中 r14 = rsp
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">12</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40110</span><span style="color:#91d7e3">e:</span>   <span style="color:#ed8796">41</span> <span style="color:#8aadf4">bc</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>       <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x0</span>,<span style="color:#f4dbd6">%r12d</span>           <span style="color:#6e738d;font-style:italic"># 将r12置零 r12 = 0
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">13</span><span><span style="color:#6e738d;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">14</span><span>  <span style="color:#ed8796">401114:</span>   <span style="color:#ed8796">4</span><span style="color:#8aadf4">c</span> <span style="color:#f5a97f">89</span> <span style="color:#eed49f">ed</span>                <span style="color:#eed49f">mov</span>    <span style="color:#f4dbd6">%r13</span>,<span style="color:#f4dbd6">%rbp</span>            <span style="color:#6e738d;font-style:italic"># 将r13的数据置给rbp，也就是说使得rbp = rsp，rbp = rsp + 4（第二次）
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">15</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401117:</span>   <span style="color:#ed8796">41</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">45</span> <span style="color:#f5a97f">00</span>             <span style="color:#eed49f">mov</span>    <span style="color:#f5a97f">0x0</span>(<span style="color:#f4dbd6">%r13</span>),<span style="color:#f4dbd6">%eax</span>       <span style="color:#6e738d;font-style:italic"># 获取第一个数字，传给eax | 获取第二个数字
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">16</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40111</span><span style="color:#91d7e3">b:</span>   <span style="color:#ed8796">83</span> <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">01</span>                <span style="color:#eed49f">sub</span>    <span style="color:#eed49f">$0x1</span>,<span style="color:#f4dbd6">%eax</span>            <span style="color:#6e738d;font-style:italic"># 将第一个数字-1 | 第二个数字-1
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">17</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40111</span><span style="color:#91d7e3">e:</span>   <span style="color:#ed8796">83</span> <span style="color:#8aadf4">f8</span> <span style="color:#f5a97f">05</span>                <span style="color:#eed49f">cmp</span>    <span style="color:#eed49f">$0x5</span>,<span style="color:#f4dbd6">%eax</span>            <span style="color:#6e738d;font-style:italic"># 与5比较
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">18</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401121:</span>   <span style="color:#ed8796">76</span> <span style="color:#ed8796">05</span>                   <span style="color:#8aadf4">jbe</span>    <span style="color:#f5a97f">401128</span> &lt;<span style="color:#eed49f">phase_6</span>+<span style="color:#f5a97f">0x34</span>&gt;<span style="color:#6e738d;font-style:italic"># 如果 数字-1 &lt;= 5，就跳转28处，这说明数字必须小于等于6
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">19</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401123:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">12</span> <span style="color:#f5a97f">03</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40143a</span> &lt;<span style="color:#eed49f">explode_bomb</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">20</span><span>  <span style="color:#ed8796">401128:</span>   <span style="color:#ed8796">41</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c4</span> <span style="color:#f5a97f">01</span>             <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x1</span>,<span style="color:#f4dbd6">%r12d</span>           <span style="color:#6e738d;font-style:italic"># 给r12+1，此时r12 = 1
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">21</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40112</span><span style="color:#91d7e3">c:</span>   <span style="color:#ed8796">41</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">fc</span> <span style="color:#f5a97f">06</span>             <span style="color:#eed49f">cmp</span>    <span style="color:#eed49f">$0x6</span>,<span style="color:#f4dbd6">%r12d</span>           <span style="color:#6e738d;font-style:italic"># 将r12与6比较
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">22</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401130:</span>   <span style="color:#ed8796">74</span> <span style="color:#ed8796">21</span>                   <span style="color:#8aadf4">je</span>     <span style="color:#f5a97f">401153</span> &lt;<span style="color:#eed49f">phase_6</span>+<span style="color:#f5a97f">0x5f</span>&gt;<span style="color:#6e738d;font-style:italic"># 如果相等就跳转53
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">23</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401132:</span>   <span style="color:#ed8796">44</span> <span style="color:#ed8796">89</span> <span style="color:#8aadf4">e3</span>                <span style="color:#eed49f">mov</span>    <span style="color:#f4dbd6">%r12d</span>,<span style="color:#f4dbd6">%ebx</span>           <span style="color:#6e738d;font-style:italic"># 将r12的值放入ebx，ebx = 1
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">24</span><span><span style="color:#6e738d;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">25</span><span>  <span style="color:#ed8796">401135:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">63</span> <span style="color:#8aadf4">c3</span>                <span style="color:#eed49f">movslq</span> <span style="color:#f4dbd6">%ebx</span>,<span style="color:#f4dbd6">%rax</span>            <span style="color:#6e738d;font-style:italic"># 将ebx的值放入rax，rax = 1
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">26</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401138:</span>   <span style="color:#ed8796">8</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">04</span> <span style="color:#f5a97f">84</span>                <span style="color:#eed49f">mov</span>    (<span style="color:#f4dbd6">%rsp</span>,<span style="color:#f4dbd6">%rax</span>,<span style="color:#f5a97f">4</span>),<span style="color:#f4dbd6">%eax</span>   <span style="color:#6e738d;font-style:italic"># 将rsp+4*rax指向的数据放入eax，也就是第二个数据
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">27</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40113</span><span style="color:#91d7e3">b:</span>   <span style="color:#ed8796">39</span> <span style="color:#ed8796">45</span> <span style="color:#ed8796">00</span>                <span style="color:#8aadf4">cmp</span>    <span style="color:#f4dbd6">%eax</span>,<span style="color:#f5a97f">0x0</span>(<span style="color:#f4dbd6">%rbp</span>)       <span style="color:#6e738d;font-style:italic"># 比较eax和第一个数字，比较第一二个数字
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">28</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40113</span><span style="color:#91d7e3">e:</span>   <span style="color:#ed8796">75</span> <span style="color:#ed8796">05</span>                   <span style="color:#8aadf4">jne</span>    <span style="color:#f5a97f">401145</span> &lt;<span style="color:#eed49f">phase_6</span>+<span style="color:#f5a97f">0x51</span>&gt;<span style="color:#6e738d;font-style:italic"># 如果不相等就跳转45处，也就是说让第1 2个数字不相等
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">29</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401140:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#eed49f">f5</span> <span style="color:#f5a97f">02</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40143a</span> &lt;<span style="color:#eed49f">explode_bomb</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">30</span><span>  <span style="color:#ed8796">401145:</span>   <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c3</span> <span style="color:#f5a97f">01</span>                <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x1</span>,<span style="color:#f4dbd6">%ebx</span>            <span style="color:#6e738d;font-style:italic"># ebx = 2
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">31</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401148:</span>   <span style="color:#ed8796">83</span> <span style="color:#8aadf4">fb</span> <span style="color:#f5a97f">05</span>                <span style="color:#eed49f">cmp</span>    <span style="color:#eed49f">$0x5</span>,<span style="color:#f4dbd6">%ebx</span>            <span style="color:#6e738d;font-style:italic"># 将ebx与5比较
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">32</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40114</span><span style="color:#91d7e3">b:</span>   <span style="color:#ed8796">7</span><span style="color:#8aadf4">e</span> <span style="color:#eed49f">e8</span>                   <span style="color:#eed49f">jle</span>    <span style="color:#f5a97f">401135</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">33</span><span>  <span style="color:#ed8796">&lt;</span><span style="color:#eed49f">phase_6</span><span style="color:#ed8796">+</span><span style="color:#f5a97f">0x41</span><span style="color:#ed8796">&gt;</span><span style="color:#6e738d;font-style:italic"># ebx &lt;= 5就跳转35处，所以此处是个循环，循环比较其他数字和第一个数字，让所有数字都不与第一个数字相同
</span></span></span></code></pre></div><p>这一段的意思很简单，就是从input中读6个数字，将其与6比较，保证每个数字都小于等于6.</p>
<p>同时后面有个双层循环，使得6个数字互不相等。所以按照推测后面的代码应该是决定这六个数字的顺序</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 1</span><span>  <span style="color:#ed8796">40114</span><span style="color:#91d7e3">d:</span>   <span style="color:#ed8796">49</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c5</span> <span style="color:#f5a97f">04</span>             <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x4</span>,<span style="color:#f4dbd6">%r13</span>            <span style="color:#6e738d;font-style:italic"># r13等于rsp，相当于让r13指向第二个数字
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 2</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401151:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#eed49f">c1</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">401114</span> &lt;<span style="color:#eed49f">phase_6</span>+<span style="color:#f5a97f">0x20</span>&gt;<span style="color:#6e738d;font-style:italic"># 这里也是循环，相当于让每个数字都相互比较，使之个个都不相等，且小于等于6
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 3</span><span><span style="color:#6e738d;font-style:italic"></span>                                                                
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 4</span><span>  <span style="color:#ed8796">401153:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">74</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">18</span>          <span style="color:#eed49f">lea</span>    <span style="color:#f5a97f">0x18</span>(<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%rsi</span>      <span style="color:#6e738d;font-style:italic"># 把rsp+18地址给rsi，也就是最后一个元素
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 5</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401158:</span>   <span style="color:#ed8796">4</span><span style="color:#8aadf4">c</span> <span style="color:#f5a97f">89</span> <span style="color:#eed49f">f0</span>                <span style="color:#eed49f">mov</span>    <span style="color:#f4dbd6">%r14</span>,<span style="color:#f4dbd6">%rax</span>            <span style="color:#6e738d;font-style:italic"># 让rax = r14 = rsp
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 6</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40115</span><span style="color:#91d7e3">b:</span>   <span style="color:#8aadf4">b9</span> <span style="color:#f5a97f">07</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x7</span>,<span style="color:#f4dbd6">%ecx</span>            <span style="color:#6e738d;font-style:italic"># 让ecx = 0x7
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 7</span><span><span style="color:#6e738d;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 8</span><span>  <span style="color:#ed8796">401160:</span>   <span style="color:#ed8796">89</span> <span style="color:#8aadf4">ca</span>                   <span style="color:#eed49f">mov</span>    <span style="color:#f4dbd6">%ecx</span>,<span style="color:#f4dbd6">%edx</span>            <span style="color:#6e738d;font-style:italic"># 让edx = ecx = 0x7
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 9</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401162:</span>   <span style="color:#ed8796">2</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">10</span>                   <span style="color:#eed49f">sub</span>    (<span style="color:#f4dbd6">%rax</span>),<span style="color:#f4dbd6">%edx</span>          <span style="color:#6e738d;font-style:italic"># 让0x7 - 第一个元素
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">10</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401164:</span>   <span style="color:#ed8796">89</span> <span style="color:#ed8796">10</span>                   <span style="color:#8aadf4">mov</span>    <span style="color:#f4dbd6">%edx</span>,(<span style="color:#f4dbd6">%rax</span>)          <span style="color:#6e738d;font-style:italic"># 把结果再放到原位置
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">11</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401166:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c0</span> <span style="color:#f5a97f">04</span>             <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x4</span>,<span style="color:#f4dbd6">%rax</span>            <span style="color:#6e738d;font-style:italic"># 移动到下一个元素
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">12</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40116</span><span style="color:#91d7e3">a:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">39</span> <span style="color:#8aadf4">f0</span>                <span style="color:#eed49f">cmp</span>    <span style="color:#f4dbd6">%rsi</span>,<span style="color:#f4dbd6">%rax</span>            <span style="color:#6e738d;font-style:italic"># 比较是否到达最后一个元素
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">13</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40116</span><span style="color:#91d7e3">d:</span>   <span style="color:#ed8796">75</span> <span style="color:#8aadf4">f1</span>                   <span style="color:#eed49f">jne</span>    <span style="color:#f5a97f">401160</span> &lt;<span style="color:#eed49f">phase_6</span>+<span style="color:#f5a97f">0x6c</span>&gt;<span style="color:#6e738d;font-style:italic"># 如果没到就跳转到60处，继续这个循环，相当于让每个数字=0x7-数字
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">14</span><span><span style="color:#6e738d;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">15</span><span>  <span style="color:#ed8796">40116</span><span style="color:#91d7e3">f:</span>   <span style="color:#8aadf4">be</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x0</span>,<span style="color:#f4dbd6">%esi</span>            <span style="color:#6e738d;font-style:italic"># esi = 0
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">16</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401174:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#f5a97f">21</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">401197</span> &lt;<span style="color:#eed49f">phase_6</span>+<span style="color:#f5a97f">0xa3</span>&gt;<span style="color:#6e738d;font-style:italic"># 跳转到97处，此时上一个循环完毕开启下一个循环
</span></span></span></code></pre></div><p>让每个数字都等于7-数字，目前尚且不知道有啥用</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 1</span><span>  <span style="color:#ed8796">401176:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">52</span> <span style="color:#f5a97f">08</span>             <span style="color:#eed49f">mov</span>    <span style="color:#f5a97f">0x8</span>(<span style="color:#f4dbd6">%rdx</span>),<span style="color:#f4dbd6">%rdx</span>       <span style="color:#6e738d;font-style:italic"># rdx存储rdx+0x8处的数据，这里一直不明白，看了别人的解析才懂原来是链表操作
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 2</span><span><span style="color:#6e738d;font-style:italic"></span>                                                                <span style="color:#6e738d;font-style:italic"># 相当于把下一个节点的指针放到rdx里
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 3</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40117</span><span style="color:#91d7e3">a:</span>   <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c0</span> <span style="color:#f5a97f">01</span>                <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x1</span>,<span style="color:#f4dbd6">%eax</span>            <span style="color:#6e738d;font-style:italic"># 让eax++，eax随着循环内部循环增长，比较其与大于1的元素的关系
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 4</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40117</span><span style="color:#91d7e3">d:</span>   <span style="color:#ed8796">39</span> <span style="color:#8aadf4">c8</span>                   <span style="color:#eed49f">cmp</span>    <span style="color:#f4dbd6">%ecx</span>,<span style="color:#f4dbd6">%eax</span>            <span style="color:#6e738d;font-style:italic"># 比较ecx和eax，而ecx是大于1的元素
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 5</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40117</span><span style="color:#91d7e3">f:</span>   <span style="color:#ed8796">75</span> <span style="color:#8aadf4">f5</span>                   <span style="color:#eed49f">jne</span>    <span style="color:#f5a97f">401176</span> &lt;<span style="color:#eed49f">phase_6</span>+<span style="color:#f5a97f">0x82</span>&gt;<span style="color:#6e738d;font-style:italic"># 如果不相等就跳转76，继续让rdx前进，同时让eax+1，也就是找到存放指定数据的节点
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 6</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401181:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#f5a97f">05</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">401188</span> &lt;<span style="color:#eed49f">phase_6</span>+<span style="color:#f5a97f">0x94</span>&gt;<span style="color:#6e738d;font-style:italic"># 反之跳转88，也就是说找到和数字匹配的链表节点
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 7</span><span><span style="color:#6e738d;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 8</span><span>  <span style="color:#ed8796">401183:</span>   <span style="color:#8aadf4">ba</span> <span style="color:#eed49f">d0</span> <span style="color:#f5a97f">32</span> <span style="color:#f5a97f">60</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x6032d0</span>,<span style="color:#f4dbd6">%edx</span>       <span style="color:#6e738d;font-style:italic"># 又让edx存了该地址，小于1的逻辑，gdb看了一下，这是链表head地址
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 9</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401188:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">89</span> <span style="color:#ed8796">54</span> <span style="color:#ed8796">74</span> <span style="color:#ed8796">20</span>          <span style="color:#8aadf4">mov</span>    <span style="color:#f4dbd6">%rdx</span>,<span style="color:#f5a97f">0x20</span>(<span style="color:#f4dbd6">%rsp</span>,<span style="color:#f4dbd6">%rsi</span>,<span style="color:#f5a97f">2</span>)<span style="color:#6e738d;font-style:italic"># 让rdx放到rsp + 0x20 + rsi * 2处。
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">10</span><span><span style="color:#6e738d;font-style:italic"></span>                                                                <span style="color:#6e738d;font-style:italic"># 说明栈中元素大小是8，也就是说栈上存的是指针，这里就是把每个节点的指针保存下来，保存到栈上
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">11</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40118</span><span style="color:#91d7e3">d:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c6</span> <span style="color:#f5a97f">04</span>             <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x4</span>,<span style="color:#f4dbd6">%rsi</span>            <span style="color:#6e738d;font-style:italic"># 让rsi移动4
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">12</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401191:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">fe</span> <span style="color:#f5a97f">18</span>             <span style="color:#eed49f">cmp</span>    <span style="color:#eed49f">$0x18</span>,<span style="color:#f4dbd6">%rsi</span>           <span style="color:#6e738d;font-style:italic"># 比较rsi与0x18，24是终点，说明要移动6次到达终点
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">13</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">401195:</span>   <span style="color:#ed8796">74</span> <span style="color:#ed8796">14</span>                   <span style="color:#8aadf4">je</span>     <span style="color:#f5a97f">4011ab</span> &lt;<span style="color:#eed49f">phase_6</span>+<span style="color:#f5a97f">0xb7</span>&gt;<span style="color:#6e738d;font-style:italic"># 如果相等就跳转ab处，显然一开始不会相等，所以要循环
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">14</span><span><span style="color:#6e738d;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">15</span><span>  <span style="color:#ed8796">401197:</span>   <span style="color:#ed8796">8</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">0</span><span style="color:#eed49f">c</span> <span style="color:#f5a97f">34</span>                <span style="color:#eed49f">mov</span>    (<span style="color:#f4dbd6">%rsp</span>,<span style="color:#f4dbd6">%rsi</span>,<span style="color:#f5a97f">1</span>),<span style="color:#f4dbd6">%ecx</span>   <span style="color:#6e738d;font-style:italic"># 使得ecx的值为rsp + rsi指向处，猜测也是移动指针，此时ecx中保存第一个元素，第二次进来就是第二个数据
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">16</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40119</span><span style="color:#91d7e3">a:</span>   <span style="color:#ed8796">83</span> <span style="color:#8aadf4">f9</span> <span style="color:#f5a97f">01</span>                <span style="color:#eed49f">cmp</span>    <span style="color:#eed49f">$0x1</span>,<span style="color:#f4dbd6">%ecx</span>            <span style="color:#6e738d;font-style:italic"># 比较第一个元素与1  比较第二个数据
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">17</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">40119</span><span style="color:#91d7e3">d:</span>   <span style="color:#ed8796">7</span><span style="color:#8aadf4">e</span> <span style="color:#eed49f">e4</span>                   <span style="color:#eed49f">jle</span>    <span style="color:#f5a97f">401183</span> &lt;<span style="color:#eed49f">phase_6</span>+<span style="color:#f5a97f">0x8f</span>&gt;<span style="color:#6e738d;font-style:italic"># 如果ecx &lt;= 0x1，就跳转83位置，也就是说该循环比较每个元素与1的大小，所以83处是&lt;=1的处理逻辑
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">18</span><span><span style="color:#6e738d;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">19</span><span>  <span style="color:#ed8796">40119</span><span style="color:#91d7e3">f:</span>   <span style="color:#8aadf4">b8</span> <span style="color:#f5a97f">01</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x1</span>,<span style="color:#f4dbd6">%eax</span>            <span style="color:#6e738d;font-style:italic"># eax = 1，这是大于1的处理逻辑
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">20</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">a4:</span>   <span style="color:#8aadf4">ba</span> <span style="color:#eed49f">d0</span> <span style="color:#f5a97f">32</span> <span style="color:#f5a97f">60</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x6032d0</span>,<span style="color:#f4dbd6">%edx</span>       <span style="color:#6e738d;font-style:italic"># edx存的是0x6032d0这个地址
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">21</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">a9:</span>   <span style="color:#8aadf4">eb</span> <span style="color:#eed49f">cb</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">401176</span> &lt;<span style="color:#eed49f">phase_6</span>+<span style="color:#f5a97f">0x82</span>&gt;<span style="color:#6e738d;font-style:italic"># 跳转76处
</span></span></span></code></pre></div><p>这里出现了一个地址0x6032d0，用gdb查看一下其内存数据，发现是链表，很显然可以看到低地址是数据，高地址是指针。这里要注意第一行的数据其实就是跑到移动到下一个节点。</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">1</span><span><span style="color:#91d7e3;font-weight:bold">(</span>gdb<span style="color:#91d7e3;font-weight:bold">)</span> x/12xg 0x6032d0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">2</span><span>0x6032d0 &lt;node1&gt;:       0x000000010000014c      0x00000000006032e0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">3</span><span>0x6032e0 &lt;node2&gt;:       0x00000002000000a8      0x00000000006032f0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">4</span><span>0x6032f0 &lt;node3&gt;:       0x000000030000039c      0x0000000000603300
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">5</span><span>0x603300 &lt;node4&gt;:       0x00000004000002b3      0x0000000000603310
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">6</span><span>0x603310 &lt;node5&gt;:       0x00000005000001dd      0x0000000000603320
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">7</span><span>0x603320 &lt;node6&gt;:       0x00000006000001bb      0x0000000000000000
</span></span></code></pre></div><p>此处逻辑就是把链表中每个节点的地址按照六个数字的顺序放入栈中</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 1</span><span>                                                                <span style="color:#6e738d;font-style:italic"># 代码到达此处之前已经完成了寻找操作，此时从rsp+0x20处开始都是指针数据，大小为8字节
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 2</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">ab:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">5</span><span style="color:#eed49f">c</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">20</span>          <span style="color:#eed49f">mov</span>    <span style="color:#f5a97f">0x20</span>(<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%rbx</span>      <span style="color:#6e738d;font-style:italic"># 把rsp+0x20处的数据放到rbx中       也就是说是第一个节点内的数据
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 3</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">b0:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">44</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">28</span>          <span style="color:#eed49f">lea</span>    <span style="color:#f5a97f">0x28</span>(<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%rax</span>      <span style="color:#6e738d;font-style:italic"># 让0x28+rsp放到rax处 循环开始位置  也就是说是第二个节点的地址
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 4</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">b5:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">74</span> <span style="color:#f5a97f">24</span> <span style="color:#f5a97f">50</span>          <span style="color:#eed49f">lea</span>    <span style="color:#f5a97f">0x50</span>(<span style="color:#f4dbd6">%rsp</span>),<span style="color:#f4dbd6">%rsi</span>      <span style="color:#6e738d;font-style:italic"># 让0x50+rsp放到rsi处 循环结束位置  最后一个位置
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 5</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">ba:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">89</span> <span style="color:#8aadf4">d9</span>                <span style="color:#eed49f">mov</span>    <span style="color:#f4dbd6">%rbx</span>,<span style="color:#f4dbd6">%rcx</span>            <span style="color:#6e738d;font-style:italic"># rcx = rsp + 0x20处的数据。        也就是第一个节点内的数据
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 6</span><span><span style="color:#6e738d;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 7</span><span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">bd:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">10</span>                <span style="color:#eed49f">mov</span>    (<span style="color:#f4dbd6">%rax</span>),<span style="color:#f4dbd6">%rdx</span>          <span style="color:#6e738d;font-style:italic"># 取第二个节点数据，将其放到rdx中
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 8</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">c0:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">89</span> <span style="color:#ed8796">51</span> <span style="color:#ed8796">08</span>             <span style="color:#8aadf4">mov</span>    <span style="color:#f4dbd6">%rdx</span>,<span style="color:#f5a97f">0x8</span>(<span style="color:#f4dbd6">%rcx</span>)       <span style="color:#6e738d;font-style:italic"># 其实就是把节点重新连接了起来，按照在栈中的顺序，得偏移8个字节才能找到指向下一个节点的指针
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 9</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">c4:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c0</span> <span style="color:#f5a97f">08</span>             <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x8</span>,<span style="color:#f4dbd6">%rax</span>            <span style="color:#6e738d;font-style:italic"># 把rax数据+8 rax = 0x30 + rsp，移动循环变量 
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">10</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">c8:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">39</span> <span style="color:#8aadf4">f0</span>                <span style="color:#eed49f">cmp</span>    <span style="color:#f4dbd6">%rsi</span>,<span style="color:#f4dbd6">%rax</span>            <span style="color:#6e738d;font-style:italic"># 比较rsi和rax，看看是否到了结尾
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">11</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">cb:</span>   <span style="color:#ed8796">74</span> <span style="color:#ed8796">05</span>                   <span style="color:#8aadf4">je</span>     <span style="color:#f5a97f">4011d2</span> &lt;<span style="color:#eed49f">phase_6</span>+<span style="color:#f5a97f">0xde</span>&gt;<span style="color:#6e738d;font-style:italic"># 如果相等就跳d2
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">12</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">cd:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">89</span> <span style="color:#8aadf4">d1</span>                <span style="color:#eed49f">mov</span>    <span style="color:#f4dbd6">%rdx</span>,<span style="color:#f4dbd6">%rcx</span>            
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">13</span><span>  <span style="color:#f5a97f">4011</span><span style="color:#eed49f">d0</span>:   <span style="color:#eed49f">eb</span> <span style="color:#eed49f">eb</span>                   <span style="color:#eed49f">jmp</span>    <span style="color:#f5a97f">4011bd</span> &lt;<span style="color:#eed49f">phase_6</span>+<span style="color:#f5a97f">0xc9</span>&gt;<span style="color:#6e738d;font-style:italic"># 跳转到bd处
</span></span></span></code></pre></div><p>可以看到这里其实就是把栈中的链表节点按照栈中的顺序连接起来！</p>
<div class="highlight"><pre tabindex="0" style="color:#cad3f5;background-color:#24273a;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 1</span><span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">d2:</span>   <span style="color:#ed8796">48</span> <span style="color:#8aadf4">c7</span> <span style="color:#f5a97f">42</span> <span style="color:#f5a97f">08</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>    <span style="color:#eed49f">movq</span>   <span style="color:#eed49f">$0x0</span>,<span style="color:#f5a97f">0x8</span>(<span style="color:#f4dbd6">%rdx</span>)       <span style="color:#6e738d;font-style:italic"># 给最后一个节点的指针域赋值为null
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 2</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">d9:</span>   <span style="color:#ed8796">00</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 3</span><span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">da:</span>   <span style="color:#8aadf4">bd</span> <span style="color:#f5a97f">05</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">mov</span>    <span style="color:#eed49f">$0x5</span>,<span style="color:#f4dbd6">%ebp</span>            <span style="color:#6e738d;font-style:italic"># 把0x5赋值为ebp
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 4</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">df:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">43</span> <span style="color:#f5a97f">08</span>             <span style="color:#eed49f">mov</span>    <span style="color:#f5a97f">0x8</span>(<span style="color:#f4dbd6">%rbx</span>),<span style="color:#f4dbd6">%rax</span>       <span style="color:#6e738d;font-style:italic"># 将下一个节点的地址赋值给rax，因为在上一轮循环中rbx指向第一个链表元素
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 5</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">e3:</span>   <span style="color:#ed8796">8</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">00</span>                   <span style="color:#eed49f">mov</span>    (<span style="color:#f4dbd6">%rax</span>),<span style="color:#f4dbd6">%eax</span>          <span style="color:#6e738d;font-style:italic"># 访问节点的数据，并将数据复制给eax，注意这里只复制了低4个字节，从gdb中可以看到是有一串数字的
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 6</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">e5:</span>   <span style="color:#ed8796">39</span> <span style="color:#ed8796">03</span>                   <span style="color:#8aadf4">cmp</span>    <span style="color:#f4dbd6">%eax</span>,(<span style="color:#f4dbd6">%rbx</span>)          <span style="color:#6e738d;font-style:italic"># 比较eax和rbx，也就是说上一个节点和下一个节点比较
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 7</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">e7:</span>   <span style="color:#ed8796">7</span><span style="color:#8aadf4">d</span> <span style="color:#f5a97f">05</span>                   <span style="color:#eed49f">jge</span>    <span style="color:#f5a97f">4011ee</span> &lt;<span style="color:#eed49f">phase_6</span>+<span style="color:#f5a97f">0xfa</span>&gt;<span style="color:#6e738d;font-style:italic"># 要让上一个节点的数据大于下一个节点的数据
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 8</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">e9:</span>   <span style="color:#8aadf4">e8</span> <span style="color:#f5a97f">4</span><span style="color:#eed49f">c</span> <span style="color:#f5a97f">02</span> <span style="color:#f5a97f">00</span> <span style="color:#f5a97f">00</span>          <span style="color:#eed49f">callq</span>  <span style="color:#f5a97f">40143a</span> &lt;<span style="color:#eed49f">explode_bomb</span>&gt;<span style="color:#6e738d;font-style:italic"># 否则就引爆
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2"> 9</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">ee:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">8</span><span style="color:#8aadf4">b</span> <span style="color:#f5a97f">5</span><span style="color:#eed49f">b</span> <span style="color:#f5a97f">08</span>             <span style="color:#eed49f">mov</span>    <span style="color:#f5a97f">0x8</span>(<span style="color:#f4dbd6">%rbx</span>),<span style="color:#f4dbd6">%rbx</span>       <span style="color:#6e738d;font-style:italic"># 移动链表
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">10</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">f2:</span>   <span style="color:#ed8796">83</span> <span style="color:#8aadf4">ed</span> <span style="color:#f5a97f">01</span>                <span style="color:#eed49f">sub</span>    <span style="color:#eed49f">$0x1</span>,<span style="color:#f4dbd6">%ebp</span>            <span style="color:#6e738d;font-style:italic"># 减去控制移动的东西，检查是否遍历完成
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">11</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">f5:</span>   <span style="color:#ed8796">75</span> <span style="color:#8aadf4">e8</span>                   <span style="color:#eed49f">jne</span>    <span style="color:#f5a97f">4011df</span> &lt;<span style="color:#eed49f">phase_6</span>+<span style="color:#f5a97f">0xeb</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">13</span><span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">f7:</span>   <span style="color:#ed8796">48</span> <span style="color:#ed8796">83</span> <span style="color:#8aadf4">c4</span> <span style="color:#f5a97f">50</span>             <span style="color:#eed49f">add</span>    <span style="color:#eed49f">$0x50</span>,<span style="color:#f4dbd6">%rsp</span>           <span style="color:#6e738d;font-style:italic"># 恢复现场
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">14</span><span><span style="color:#6e738d;font-style:italic"></span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">fb:</span>   <span style="color:#ed8796">5</span><span style="color:#8aadf4">b</span>                      <span style="color:#eed49f">pop</span>    <span style="color:#f4dbd6">%rbx</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">15</span><span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">fc:</span>   <span style="color:#ed8796">5</span><span style="color:#8aadf4">d</span>                      <span style="color:#eed49f">pop</span>    <span style="color:#f4dbd6">%rbp</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">16</span><span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">fd:</span>   <span style="color:#ed8796">41</span> <span style="color:#ed8796">5</span><span style="color:#8aadf4">c</span>                   <span style="color:#eed49f">pop</span>    <span style="color:#f4dbd6">%r12</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">17</span><span>  <span style="color:#ed8796">4011</span><span style="color:#91d7e3">ff:</span>   <span style="color:#ed8796">41</span> <span style="color:#ed8796">5</span><span style="color:#8aadf4">d</span>                   <span style="color:#eed49f">pop</span>    <span style="color:#f4dbd6">%r13</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">18</span><span>  <span style="color:#ed8796">401201:</span>   <span style="color:#ed8796">41</span> <span style="color:#ed8796">5</span><span style="color:#8aadf4">e</span>                   <span style="color:#eed49f">pop</span>    <span style="color:#f4dbd6">%r14</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#8087a2">19</span><span>  <span style="color:#ed8796">401203:</span>   <span style="color:#8aadf4">c3</span>                      <span style="color:#eed49f">retq</span> 
</span></span></code></pre></div><p>先把最后一个节点的指针赋值为null，并通过ebp控制循环次数，检验链表前一个节点数据必须大于后一个节点数据！
所以根据gdb中的链表数据显示，在7减去数字之后的顺序应该是：<code>3 4 5 6 1 2</code>
也就是说初始数字应该是<code>4 3 2 1 6 5</code></p>
<h1 id="小结">小结</h1>
<p>看起来好像还有个secret phase，不过到此汇编应该就结束了，追求的也是能看懂，目前看简单的汇编也是没有问题了，bomb实验真的不错！之后有空再推进吧。</p>
<p>八股，爷来了！</p>
<h1 id="参考">参考</h1>
<ol>
<li><a href="https://arthals.ink/posts/experience/bomb-lab" target="_blank" rel="noopener">老哥1</a></li>
<li><a href="https://www.viseator.com/2017/06/21/CS_APP_BombLab/#%E9%98%B6%E6%AE%B5%E4%B8%89" target="_blank" rel="noopener">老哥2</a></li>
<li><a href="https://wdxtub.com/csapp/thick-csapp-lab-2/2016/04/16/" target="_blank" rel="noopener">老哥3</a></li>
</ol>

        </div>
    </div>
    <a href="#" id="scrollToTopButton">
        <svg t="1686753152588" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
            p-id="3988" width="48" height="48">
            <path
                d="M518.5 360.3c-3.2-4.4-9.7-4.4-12.9 0l-178 246c-3.8 5.3 0 12.7 6.5 12.7H381c10.2 0 19.9-4.9 25.9-13.2L512 460.4l105.2 145.4c6 8.3 15.6 13.2 25.9 13.2H690c6.5 0 10.3-7.4 6.5-12.7l-178-246z"
                p-id="3989" fill="#363636"></path>
            <path
                d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64z m0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"
                p-id="3990" fill="#363636"></path>
        </svg>
    </a><hr style="border-top: 1px solid #EEEEEE;">
<div id="comment"></div>
<script>
    const getStoredTheme = () => localStorage.getItem("theme") === "dark" ? "dark" : "light";

    const setGiscusTheme = () => {
        const sendMessage = (message) => {
            const iframe = document.querySelector('iframe.giscus-frame');
            if (iframe) {
                iframe.contentWindow.postMessage({giscus: message}, 'https://giscus.app');
            }
        }
        sendMessage({setConfig: {theme: getStoredTheme()}})
    }

    document.addEventListener("DOMContentLoaded", () => {
        const giscusAttributes = {
            "src": "https://giscus.app/client.js",
            "data-repo": "O-A-P\/O-A-P.github.io",
            "data-repo-id": "R_kgDOJEfHWQ",
            "data-category": "Announcements",
            "data-category-id": "DIC_kwDOJEfHWc4CcDhX",
            "data-mapping": "og:title",
            "data-reactions-enabled": "1",
            "data-emit-metadata": "0",
            "data-input-position": "bottom",
            "data-theme": getStoredTheme(),
            "data-lang": "en",
            "data-loading": "lazy",
            "crossorigin": "anonymous",
        };

        
        const giscusScript = document.createElement("script");
        Object.entries(giscusAttributes).forEach(
            ([key, value]) => giscusScript.setAttribute(key, value));
        document.getElementById("comment").appendChild(giscusScript);

        
        const themeToggle = document.querySelector(".theme-toggle");
        if (themeToggle) {
            themeToggle.addEventListener("click", setGiscusTheme);
        }
    });

</script>


<div class="pp-container">
        <section class="pre-and-post">
            <div class="has-text-left">
                
                <p>Previous post</p>
                <a class="hover-underline-animation" href="https://o-a-p.github.io/post/os/6.s081-os-scheduling/">6.S081：xv6 进程调度</a>
                
            </div>
            <div class="has-text-right ">
                
                <p>Next post</p>
                <a class="hover-underline-animation" href="https://o-a-p.github.io/post/travel/nanchang/">再会南昌</a>
                
            </div>
        </section>
    </div>

</div>

        </main><footer class="footer">
    <div class="content has-text-centered">
    <span>&copy; 2025 <a href="https://o-a-p.github.io/">超级码里奥</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" target="_blank">Hugo</a> &
        <a href="https://github.com/hotjuicew/hugo-JuiceBar" target="_blank">JuiceBar </a>modified by
        <a href="https://github.com/O-A-P/O-A-P.github.io" target="_blank">
            O-A-P
        </a>
         
    </span>
    </div>

    <script src="/js/copy-to-clipboard.js"></script>
    <script src="//tokinx.github.io/ViewImage/view-image.min.js"></script>
<script>
  
  window.ViewImage && ViewImage.init('.article-content img')
</script>

  </footer></body>
</html>

